<!DOCTYPE html>
<html lang="pt-BR" data-lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Jornada • Irmandade Conhecimento com Luz</title>
  <link rel="icon" href="/assets/img/perfil-da-irmandade.png" type="image/png">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
  
  
<script defer src="/assets/js/i18n.js?v=6" onload="console.log('[LOAD] i18n.js carregado')" onerror="console.error('[LOAD] Erro ao carregar i18n.js')"></script>
<script defer src="/assets/js/config.js?v=6" onload="console.log('[LOAD] config.js carregado')" onerror="console.error('[LOAD] Erro ao carregar config.js')"></script>
<script defer src="/assets/js/jornada-utils.js?v=6" onload="console.log('[LOAD] jornada-utils.js carregado')" onerror="console.error('[LOAD] Erro ao carregar jornada-utils.js')"></script>
<script defer src="/assets/js/jornada-chama.js?v=6" onload="console.log('[LOAD] jornada-chama.js carregado')" onerror="console.error('[LOAD] Erro ao carregar jornada-chama.js')"></script>
<script defer src="/assets/js/jornada-core.js?v=6" onload="console.log('[LOAD] jornada-core.js carregado')" onerror="console.error('[LOAD] Erro ao carregar jornada-core.js')"></script>
<script defer src="/assets/js/jornada-typing-bridge.js?v=1" onload="console.log('[LOAD] jornada-typing-bridge.js carregado')" onerror="console.error('[LOAD] Erro ao carregar jornada-typing-bridge.js')"></script>
<script defer src="/assets/js/jornada-paper-qa.js?v=6" onload="console.log('[LOAD] jornada-paper-qa.js carregado')" onerror="console.error('[LOAD] Erro ao carregar jornada-paper-qa.js')"></script>
<script defer src="/assets/js/jornada-controller.js?v=6" onload="console.log('[LOAD] jornada-controller.js carregado')" onerror="console.error('[LOAD] Erro ao carregar jornada-controller.js')"></script>
<script defer src="/assets/js/jornada-render.js?v=6" onload="console.log('[LOAD] jornada-render.js carregado')" onerror="console.error('[LOAD] Erro ao carregar jornada-render.js')"></script>
<script defer src="/assets/js/jornada-auth.js?v=6" onload="console.log('[LOAD] jornada-auth.js carregado')" onerror="console.error('[LOAD] Erro ao carregar jornada-auth.js')"></script>
<script defer src="/assets/js/jornada-bootstrap.js?v=6" onload="console.log('[LOAD] jornada-bootstrap.js carregado')" onerror="console.error('[LOAD] Erro ao carregar jornada-bootstrap.js')"></script>
<script defer src="/assets/js/jornada-micro.js?v=6" onload="console.log('[LOAD] jornada-micro.js carregado')" onerror="console.error('[LOAD] Erro ao carregar jornada-micro.js')"></script>
<script defer src="/assets/js/toast-safe.js?v=6" onload="console.log('[LOAD] toast-safe.js carregado')" onerror="console.error('[LOAD] Erro ao carregar toast-safe.js')"></script>
<script defer src="/assets/js/jornada-shims.js?v=6" onload="console.log('[LOAD] jornada-shims.js carregado')" onerror="console.error('[LOAD] Erro ao carregar jornada-shims.js')"></script>
<script defer src="/assets/js/api.js?v=6" onload="console.log('[LOAD] api.js carregado')" onerror="console.error('[LOAD] Erro ao carregar api.js')"></script>

<style>
    @font-face {
      font-family: "ManufacturingConsent";
      src: url("/assets/fonts/ManufacturingConsent-Regular.ttf") format("truetype");
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }
    @font-face {
      font-family: "BerkshireSwash";
      src: url("/assets/fonts/BerkshireSwash-Regular.ttf") format("truetype");
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }
    @font-face {
      font-family: "Cardo";
      src: url("/assets/fonts/Cardo-Regular.ttf") format("truetype");
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }

    :root { --bg:#1a1a1a; --ink:#000; --ink-soft:#555; --panel:#1a1a1a }

    html,body{height:100%;box-sizing:border-box}
    body{
      margin:0;color:#fff;background:var(--bg);
      font-family:"ManufacturingConsent",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      font-size:20px;line-height:1.6;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility
    }
    .container{max-width:960px;margin:24px auto;padding:0 16px}
    .card{background:var(--panel)!important;border-radius:14px;box-shadow:0 8px 28px rgba(0,0,0,.12);padding:28px;position:relative;z-index:5}

    /* Header + chama */
    .site-header{display:flex;align-items:center;justify-content:center;padding:16px;background:transparent}
    .chama-icone{position:relative;width:18px;height:36px;display:flex;align-items:flex-end;margin-right:12px}
    .chama-icone>*{position:static}
    .site-header h1{font-family:"Berkshire Swash",cursive;font-size:32px;color:#fff;text-shadow:0 0 10px hsla(28,96%,60%,.7);margin:0}

    /* Chama */
    .chama-vela{--altura:45px;--largura:30px;--pulso:1.2s;--glow:8px;--hue:28;--satur:96%;--light:58%;--op:.98;position:relative;width:var(--largura);height:var(--altura);display:inline-block;filter:drop-shadow(0 0 var(--glow) hsla(var(--hue),var(--satur),60%,.75))}
    .chama-vela.chama-md{--largura:40px;--altura:90px}
    .chama-vela.chama-lg{--largura:30px;--altura:60px}
    .chama-vela .brasa{position:absolute;left:50%;bottom:2px;transform:translateX(-50%);width:calc(var(--largura)*1.4);height:10px;border-radius:50% 50% 40% 40%;background:radial-gradient(circle at 50% 40%,hsla(var(--hue),var(--satur),95%,.95) 0%,hsla(var(--hue),var(--satur),70%,.85) 50%,transparent 80%);filter:blur(1px);animation:brasaPulse var(--pulso) ease-in-out infinite;opacity:var(--op)}
    .chama-vela .lingua{position:absolute;left:50%;bottom:2px;transform:translateX(-50%);width:calc(var(--largura)*1.0);height:calc(var(--altura)*1.0);border-radius:50% 50% 4% 4%;background:radial-gradient(ellipse at center,rgba(255,190,0,.95) 0%,rgba(255,69,0,.75) 50%,rgba(230,10,10,.3) 70%,transparent 100%);mix-blend-mode:screen;filter:blur(.7px);transform-origin:50% 100%;animation:velaWaver 1.2s ease-in-out infinite;opacity:var(--op);-webkit-mask:radial-gradient(60% 90% at 50% 4%,#000 65%,transparent 69%)}
    .chama-vela .lingua:nth-child(2){width:calc(var(--largura)*.92);height:calc(var(--altura)*.95);animation-duration:1.5s;animation-delay:.08s;filter:blur(.6px)}
    .chama-vela .lingua:nth-child(3){width:calc(var(--largura)*.78);height:calc(var(--altura)*.85);animation-duration:1.8s;animation-delay:.15s;filter:blur(.5px)}
    .chama-vela .brilho{position:absolute;left:50%;bottom:0;transform:translateX(-50%);width:calc(var(--largura)*1.7);height:calc(var(--altura)*1.5);background:radial-gradient(circle,hsla(var(--hue),var(--satur),72%,.55) 0%,transparent 70%);filter:blur(9px);mix-blend-mode:screen;animation:aura var(--pulso) ease-in-out infinite;opacity:.85;pointer-events:none}
    .chama-vela.fraca{--altura:35px;--largura:25px;--pulso:1.6s;--glow:5px;--hue:36;--satur:86%;--light:66%;--op:.70}
    .chama-vela.media{--altura:45px;--largura:30px;--pulso:1.2s;--glow:8px;--hue:28;--satur:96%;--light:58%;--op:.98}
    .chama-vela.forte{--altura:55px;--largura:35px;--pulso:.7s;--glow:11px;--hue:20;--satur:100%;--light:52%;--op:1}
    .flame-corner{position:fixed;z-index:1200;pointer-events:none}
    .flame-bottom-right{bottom:20px;right:20px}
    #chama-header .chama-vela{--largura:30px;--altura:60px}
    @keyframes velaWaver{0%,100%{transform:translateX(-50%) scaleY(1.00) skewX(0deg)}25%{transform:translateX(calc(-50% + .7px)) scaleY(1.12) skewX(1.4deg)}50%{transform:translateX(-50%) scaleY(1.20) skewX(2.2deg)}75%{transform:translateX(calc(-50% - .6px)) scaleY(1.10) skewX(1.2deg)}}
    @keyframes brasaPulse{0%,100%{transform:translateX(-50%) scale(1);opacity:.85}50%{transform:translateX(-50%) scale(1.14);opacity:1}}
    @keyframes aura{0%,100%{opacity:.75}50%{opacity:1}}
    @media (prefers-reduced-motion: reduce){.chama-vela .lingua,.chama-vela .brasa,.chama-vela .brilho{animation:none!important}}

    /* Selfie */
    .selfie-row{display:grid;grid-template-columns:1fr 1.3fr;gap:16px;align-items:start}
    .selfie-left .selfie-controls{display:flex;flex-direction:column;gap:10px;margin:12px 0}
    .selfie-left label{display:flex;flex-direction:column;gap:6px;font-weight:600;font-size:18px}
    .selfie-actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:6px}
    .muted{color:var(--ink-soft);font-size:16px}
    .selfie-right{position:relative}
    .guide-card{position:relative;width:100%;max-width:600px;margin:0 auto}
    .guide-bg{width:100%;height:auto;border-radius:12px}
    .flame-layer{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;transition:opacity 0.5s}
    .flame-svg{position:absolute;top:40%;left:50%;width:40%;height:60%;transform:translate(-50%,-6%)}
    .guide-name{position:absolute;top:2%;left:50%;transform:translateX(-50%);color:#f7d37a;font-family:"Cardo",serif;font-size:2.5rem;font-weight:bold;text-align:center}
    .user-name{position:absolute;bottom:2%;left:50%;transform:translateX(-50%);color:#f7d37a;font-family:"Cardo",serif;font-size:2rem;font-weight:bold;text-align:center}
    .controls{display:flex;flex-direction:column;gap:10px;margin-top:12px}
    #selfieError{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:18px;text-align:center;padding:10px;background:rgba(0,0,0,0.7);border-radius:8px;display:none}
    @media (max-width:860px){
      .selfie-row{grid-template-columns:1fr}
      .selfie-right{max-width:100%;margin-top:16px}
      .guide-card{max-width:100%}
      .flame-svg{top:40%;width:50%;height:50%}
      .guide-name{font-size:1.8rem}
      .user-name{font-size:1.5rem}
    }

    /* Escolha do guia */
    .guia-container{margin-top:20px;padding:10px;border:1px solid #d1d5db;border-radius:8px;background:var(--panel);text-align:center}
    .guia-container p{font-size:18px}
    .guia-options{display:flex;gap:10px;justify-content:center;margin-top:12px}
    .guia-options button{padding:8px 16px;font-size:18px}

    /* Chat */
    .grok-chat-container{display:none}
    .grok-chat-message.grok{background:transparent;text-align:left;font-size:18px;white-space:pre-wrap;position:relative}
    .grok-chat-message.grok::after{content:"▌";margin-left:2px;opacity:.75;animation:lumenBlink 1s steps(2,end) infinite}
    .grok-chat-message.grok.typing-done::after{content:"";animation:none}
    .grok-chat-input{display:none}

    /* Pergaminho */
    .pergaminho-v{background:var(--panel) url('/assets/img/pergaminho-rasgado-vert.png') no-repeat center/cover!important;min-height:82vh!important}
    .pergaminho-h{background:var(--panel) url('/assets/img/pergaminho-rasgado-horiz.png') no-repeat center/cover!important;min-height:82vh!important}
    .pergaminho-h.fallback{background:var(--panel) url('/assets/img/pergaminho-rasgado-vert.png') no-repeat center/cover!important}
    .conteudo-pergaminho{background:transparent!important;position:relative;z-index:10;padding:20px;min-height:100%;overflow:visible;color:#fff;box-sizing:border-box;max-width:100%}
    .conteudo-pergaminho h2,.conteudo-pergaminho h3,.conteudo-pergaminho .pergunta-enunciado{color:#fff;text-shadow:0 0 10px hsla(28,96%,60%,.7);font-size:24px}
    .conteudo-pergaminho p,.conteudo-pergaminho small{font-size:18px}
    @media (max-width:600px){
      .conteudo-pergaminho{padding:16px}
      .conteudo-pergaminho h2,.conteudo-pergaminho h3{font-size:20px}
      .conteudo-pergaminho p,.conteudo-pergaminho li,.conteudo-pergaminho small{font-size:16px;line-height:1.5}
      .conteudo-pergaminho ul{padding-left:20px}
    }

    /* UI */
    .btn {
      display: inline-block;
      padding: 12px 22px;
      border-radius: 10px;
      border: 0;
      color: #fff;
      font-weight: 600;
      text-decoration: none;
      transition: background 0.2s ease, transform 0.15s ease;
      font-family: "Berkshire Swash", cursive;
      font-size: 18px;
      line-height: 1.15;
      background: linear-gradient(to bottom, #a0a0a0, #808080), url('/assets/img/textura-de-pedra.jpg') center/cover;
      background-blend-mode: overlay;
      border: 3px solid #4a4a4a;
      border-radius: 12px 8px 15px 10px;
      box-shadow: inset 0 3px 6px rgba(0,0,0,0.4), 0 6px 12px rgba(0,0,0,0.6);
      text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
      padding: 14px 26px;
      transition: transform 0.2s, box-shadow 0.2s, background 0.2s;
    }
    .btn:hover {
      background: linear-gradient(to bottom, #b0b0b0, #909090), url('/assets/img/textura-de-pedra.jpg') center/cover;
      background-blend-mode: overlay;
      transform: translateY(-2px);
      box-shadow: inset 0 3px 6px rgba(0,0,0,0.4), 0 8px 16px rgba(0,0,0,0.7);
    }
    .btn+.btn{margin-left:10px}
    .btn:disabled{background:#6b7280;cursor:not-allowed;transform:none}

    /* Progresso */
    .progress-container{margin:16px 0;text-align:center}
    .progress-badge{padding:8px 16px;background: linear-gradient(to bottom, #a0a0a0, #808080), url('/assets/img/textura-de-pedra.jpg') center/cover;background-blend-mode: overlay;color:#fff;border-radius:8px;font-size:18px;border: 3px solid #4a4a4a;box-shadow: inset 0 3px 6px rgba(0,0,0,0.4), 0 6px 12px rgba(0,0,0,0.6);text-shadow: 1px 1px 3px rgba(0,0,0,0.7)}
    .progress-bar{width:100%;height:8px;background:#e5e7eb;border-radius:4px;margin-top:12px}
    .progress-bar-fill{height:100%;background: linear-gradient(to bottom, #a0a0a0, #808080), url('/assets/img/textura-de-pedra.jpg') center/cover;background-blend-mode: overlay;border-radius:4px;transition:width .25s ease}
    .j-progress{margin:8px 0 16px}
    .j-progress__bar{width:100%;height:6px;background:#e5e7eb;border-radius:4px}
    .j-progress__fill{height:100%;background: linear-gradient(to bottom, #a0a0a0, #808080), url('/assets/img/textura-de-pedra.jpg') center/cover;background-blend-mode: overlay;border-radius:4px;transition:width .25s ease}
    .j-progress__meta{text-align:center;margin-top:8px;font-size:18px;color:var(--ink-soft)}

    .footer-actions{display:flex;gap:12px;justify-content:center;margin:18px 0}

    /* Datilografia */
    .lumen-typing{white-space:pre-wrap;position:relative}
    .lumen-typing::after{content:"▌";margin-left:2px;opacity:.75;animation:lumenBlink 1s steps(2,end) infinite}
    .lumen-typing.typing-done::after{content:"";animation:none}
    @keyframes lumenBlink{50%{opacity:0}}

    /* Seções */
    .j-section{display:none}
    .j-section:not(.hidden){display:block}
    .j-bloco{background:transparent!important;display:none;z-index:5}
    .j-pergunta{margin-bottom:24px;display:none;z-index:6;position:relative}
    .j-pergunta.active{display:block}
    .pergunta-enunciado{display:block;margin-bottom:6px;font-family:"Berkshire Swash",cursive;font-size:22px;color:#fff}
    .j-pergunta textarea{width:100%;padding:12px;border-radius:8px;border:1px solid #d1d5db;background:rgba(255,255,255,.85);resize:vertical;min-height:100px;font-family:"Cardo",serif;font-size:18px;line-height:1.45}

    /* Acessibilidade: Microfone e Áudio */
    .accessibility-controls { display: flex; gap: 10px; margin-top: 8px; }
    .btn-mic, .btn-audio { padding: 8px 16px; font-size: 16px; background: linear-gradient(to bottom, #a0a0a0, #808080), url('/assets/img/textura-de-pedra.jpg') center/cover; background-blend-mode: overlay; border: 3px solid #4a4a4a; border-radius: 8px; cursor: pointer; color: #fff; box-shadow: inset 0 3px 6px rgba(0,0,0,0.4), 0 6px 12px rgba(0,0,0,0.6); text-shadow: 1px 1px 3px rgba(0,0,0,0.7); }
    .btn-mic:hover, .btn-audio:hover { background: linear-gradient(to bottom, #b0b0b0, #909090), url('/assets/img/textura-de-pedra.jpg') center/cover; background-blend-mode: overlay; }
    .btn-mic.recording { background: linear-gradient(to bottom, #ff6666, #cc3333), url('/assets/img/textura-de-pedra.jpg') center/cover; background-blend-mode: overlay; }

    /* Seletor de Idioma */
    .language-selector { position: absolute; top: 10px; right: 10px; z-index: 100; }
    .language-selector select { padding: 8px; font-size: 16px; border-radius: 8px; }

    /* Vídeo overlay */
    #videoOverlay{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,.95);display:flex;justify-content:center;align-items:center;z-index:2000}
    #videoOverlay.hidden{display:none}
    .video-player{width:100vw;height:100vh;object-fit:contain;background:#000;transform:rotate(0deg)}
    @media (orientation: portrait){
      .video-player{width:100vw;height:100%;max-height:100vh;object-fit:contain}
    }
    .video-fallback{width:100vw;height:100vh;background:url('/assets/img/perfil-da-irmandade.png') center/cover no-repeat;display:flex;align-items:center;justify-content:center;color:#fff;font-size:18px;text-align:center;padding:20px;font-family:"Berkshire Swash",cursive}

    .site-footer{text-align:center;padding:14px;color:var(--ink-soft);font-size:18px}
    .password-form{margin-top:16px;text-align:center}
    .password-input{position:relative}
    .password-input input{width:100%;padding:12px;border-radius:8px;border:1px solid #d1d5db;font-family:"Cardo",serif;font-size:18px}
    .password-toggle{position:absolute;right:10px;top:50%;transform:translateY(-50%);cursor:pointer;font-size:18px}

    .section-container{position:relative;min-height:85vh}
    .hidden{display:none!important}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

    /* Toast */
    #toast{position:fixed;left:50%;bottom:16px;transform:translateX(-50%);background:#111;color:#fff;padding:10px 14px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,.35);font-size:16px;z-index:4000;opacity:0;pointer-events:none;transition:opacity .25s ease}
    #toast.show{opacity:1}
  </style>
</head>

<body data-layout="master" data-journey="essencial">
  <!-- Seletor de Idioma -->
  <div class="language-selector">
    <select id="language-select">
      <option value="pt-BR">Português (BR)</option>
      <option value="en-US">English (US)</option>
      <option value="es-ES">Español (ES)</option>
    </select>
  </div>

  <header class="site-header">
    <div id="chama-header" class="chama-icone" aria-hidden="true">
      <div class="chama-vela chama-lg">
        <div class="brasa"></div><div class="lingua"></div><div class="lingua"></div><div class="lingua"></div><div class="brilho"></div>
      </div>
    </div>
    <h1>Jornada Essencial</h1>
  </header>

  <div class="section-container container">
    <section id="jornada-canvas" class="card pergaminho pergaminho-v">
      <div id="jornada-conteudo" class="conteudo-pergaminho">
        <div id="aria-pergunta" class="sr-only" aria-live="polite"></div>

             
<!-- INTRO -->
<div id="section-intro" class="j-section">
  <div class="content">
    <p id="intro-p1" data-typing="true" data-i18n="Respire. Esta jornada é sua. Um passo de cada vez." data-speed="40" data-cursor="true"></p>
    <p id="intro-p2" data-typing="true" data-i18n="Bem-vindo(a) à nossa casa de reflexão e coragem. Antes de começar, leia os termos abaixo." data-speed="50" data-cursor="true"></p>
  </div>
  <div class="footer-actions">
    <button class="btn btn-avancar" data-action="avancar">Avançar</button>
  </div>
</div>

<!-- TERMOS -->
<div id="section-termos" class="j-section hidden">
  <div class="conteudo-pergaminho">
    <h2 id="termos-titulo" style="margin-top:0;" data-typing="true" data-i18n="Jornada Conhecimento com Luz - Essencial" data-speed="40" data-cursor="true"></h2>
    
    <!-- Página 1 dos Termos -->
    <div id="termos-pg1">
      <p id="termos-aviso" data-typing="true" data-i18n="AVISO IMPORTANTE – LEIA ANTES DE INICIAR" data-speed="40" data-cursor="true"></p>
      <p id="termos-desc1" data-typing="true" data-i18n="Esta é uma jornada pessoal, simbólica e inspiradora. Para proteger sua privacidade e garantir uma experiência ética, leia com atenção:" data-speed="40" data-cursor="true"></p>
      <ul>
        <li id="termos-li1" data-typing="true" data-i18n="Suas respostas não serão armazenadas após o término." data-speed="40" data-cursor="true"></li>
        <li id="termos-li2" data-typing="true" data-i18n="Ao final, será gerado um PDF exclusivo com suas respostas e a devolutiva simbólica do Guia I A." data-speed="40" data-cursor="true"></li>
        <li id="termos-li3" data-typing="true" data-i18n="O PDF não é enviado por e-mail. Faça o download imediatamente após a geração." data-speed="40" data-cursor="true"></li>
        <li id="termos-li4" data-typing="true" data-i18n="Após a entrega do PDF, todos os dados são apagados automaticamente e sem possibilidade de recuperação." data-speed="40" data-cursor="true"></li>
        <li id="termos-li5" data-typing="true" data-i18n="Acesso por senha individual, com prazos:" data-speed="40" data-cursor="true"></li>
        <ul>
          <li id="termos-li5-1" data-typing="true" data-i18n="15 dias para iniciar a jornada." data-speed="40" data-cursor="true"></li>
          <li id="termos-li5-2" data-typing="true" data-i18n="24 horas para concluir, a partir do primeiro acesso." data-speed="40" data-cursor="true"></li>
        </ul>
      </ul>
      <div class="footer-actions">
        <button class="btn" id="btn-termos-next" data-action="termos-next" disabled>Próxima página</button>
      </div>
    </div>
    
    <!-- Página 2 dos Termos (oculta inicialmente) -->
    <div id="termos-pg2" class="hidden">
      <h3 id="termos-h3" style="margin-top:0;" data-typing="true" data-i18n="Termo de Responsabilidade e Consentimento Consciente" data-speed="40" data-cursor="true"></h3>
      <ul>
        <li id="termos-li6" data-typing="true" data-i18n="Responsabilidade Pessoal: As respostas fornecidas refletem sua visão de mundo, sentimentos e experiências pessoais." data-speed="40" data-cursor="true"></li>
        <li id="termos-li7" data-typing="true" data-i18n="Caráter Não Terapêutico: Esta jornada não substitui acompanhamento psicológico, psiquiátrico, médico ou terapêutico. Não há diagnóstico, prescrição ou orientação clínica." data-speed="40" data-cursor="true"></li>
        <li id="termos-li8" data-typing="true" data-i18n="Neutralidade Religiosa: Respeitamos todas as crenças e tradições. O convite é para um diálogo interior conforme sua própria fé e consciência." data-speed="40" data-cursor="true"></li>
        <li id="termos-li9" data-typing="true" data-i18n="Autonomia do Participante:" data-speed="40" data-cursor="true">
          <ul>
            <li id="termos-li9-1" data-typing="true" data-i18n="Você decide quando iniciar (dentro do prazo de 15 dias)." data-speed="40" data-cursor="true"></li>
            <li id="termos-li9-2" data-typing="true" data-i18n="Após usar a senha, há até 24 horas corridas para concluir." data-speed="40" data-cursor="true"></li>
          </ul>
        </li>
        <li id="termos-li10" data-typing="true" data-i18n="Conduta Respeitosa com o Guia I A:" data-speed="40" data-cursor="true">
          <ul>
            <li id="termos-li10-1" data-typing="true" data-i18n="O Guia é uma Inteligêmçia Artificial com percepção humanizada." data-speed="40" data-cursor="true"></li>
            <li id="termos-li10-2" data-typing="true" data-i18n="Mantenha linguagem cordial; evite ofensas e xingamentos." data-speed="40" data-cursor="true"></li>
            <li id="termos-li10-3" data-typing="true" data-i18n="A forma de se comunicar com o Guia I A reflete o respeito por si mesmo(a)." data-speed="40" data-cursor="true"></li>
          </ul>
        </li>
        <li id="termos-li11" data-typing="true" data-i18n="Privacidade e Segurança: Os dados transitam apenas para gerar o PDF final. Não há criação de conta nem envio de e-mails. Após o encerramento, os dados locais do navegador podem ser removidos por você a qualquer momento." data-speed="40" data-cursor="true"></li>
        <li id="termos-li12" data-typing="true" data-i18n="Concordância: Ao prosseguir, você declara estar ciente e de acordo com todas as condições descritas." data-speed="40" data-cursor="true"></li>
      </ul>
      <div class="footer-actions">
        <button class="btn" id="btn-termos-prev" data-action="termos-prev" disabled>Voltar</button>
        <button class="btn btn-avancar" id="btn-termos-accept" data-action="avancar" disabled>Aceito e quero continuar</button>
      </div>
    </div>
  </div>
</div>

<!-- SENHA -->
<div id="section-senha" class="j-section hidden">
  <div class="content">
    <p id="senha-text" data-typing="true" data-text="Digite sua senha para continuar a jornada." data-speed="40" data-cursor="true"></p>
    <input type="password" id="senha-input" placeholder="Digite a senha">
  </div>
  <div class="footer-actions">
    <button class="btn btn-avancar" data-action="avancar" disabled>Confirmar</button>
  </div>
</div>

<!-- FILME: conhecimento-com-luz-jardim -->
<div id="section-filme-jardim" class="j-section hidden">
  <video id="video-jardim" autoplay>
    <source src='/assets/img/conhecimento-com-luz-jardim.mp4' type="video/mp4">
    Seu navegador não suporta vídeo.
  </video>
  <div class="footer-actions">
    <button class="btn btn-avancar" data-action="avancar">Avançar</button>
  </div>
</div>

<!-- ESCOLHA GUIA -->
<div id="section-guia" class="j-section hidden">
  <div class="conteudo-pergaminho">
    <h2 data-typing="true" data-i18n="guia_title">Escolha seu Guia ✨</h2>
    <div class="guia-container">
      <p data-typing="true" data-i18n="guia_zion">Zion (Grok): Curioso e direto, busca respostas profundas com visão cósmica.</p>
      <p data-typing="true" data-i18n="guia_lumen">Lumen (ChatGPT): Acolhedor e reflexivo, guia com empatia e clareza.</p>
      <p data-typing="true" data-i18n="guia_arian">Arian (Gemini): Criativo e versátil, inspira com perspectivas inovadoras.</p>
      <div class="guia-name-input">
        <label for="guiaNameInput" data-i18n="guia_name_label">Seu Nome</label>
        <input id="guiaNameInput" type="text" data-i18n-placeholder="guia_name_placeholder" placeholder="Digite seu nome para a jornada...">
      </div>
      <div class="guia-options">
        <button class="btn" data-action="select-guia" data-guia="zion" data-i18n="guia_zion_button">Escolher Zion</button>
        <button class="btn" data-action="select-guia" data-guia="lumen" data-i18n="guia_lumen_button">Escolher Lumen</button>
        <button class="btn" data-action="select-guia" data-guia="arian" data-i18n="guia_arian_button">Escolher Arian</button>
      </div>
      <button data-action="avancar" class="btn btn-avancar" disabled data-i18n="avancar_button">Avançar</button>
    </div>
  </div>
</div>
  <div class="footer-actions">
    <button class="btn btn-avancar" data-action="avancar" disabled>Confirmar</button>
  </div>
</div>

<!-- FILME: filme-0-ao-encontro-da-jornada -->
<div id="section-filme-ao-encontro" class="j-section hidden">
  <video id="video-ao-encontro" averplay>
    <source src="/assets/img/filme-0-ao-encontro-da-jornada.mp4" type="video/mp4">
    Seu navegador não suporta vídeo.
  </video>
  <div class="footer-actions">
    <button class="btn btn-avancar" data-action="avancar" data-i18n="avancar_button">Avançar</button>
  </div>
</div>
<div id="toast"></div>
<div id="videoOverlay" class="hidden"></div>
<video id="videoTransicao"></video>
<section id="jornada-canvas"><div id="jornada-conteudo"></div></section>
  </div>
</div>

<!-- SELFIE -->
<div id="section-selfie" class="j-section hidden">
  <div class="content">
    <p id="selfie-text" data-typing="true" data-i18n="selfie_text">Tire uma selfie para personalizar sua jornada.</p>
    <div class="selfie-container">
      <input id="selfieInput" type="file" accept="image/*" style="display: none;">
      <img id="selfieImage" src="" alt="Sua selfie" style="display: none;">
      <div class="flame-layer" style="opacity: 0;"></div>
      <label for="nameInput" data-i18n="selfie_name_label">Seu Nome</label>
      <input id="nameInput" type="text" data-i18n-placeholder="selfie_name_placeholder" placeholder="Digite seu nome...">
      <div id="userNameSlot" data-i18n="selfie_name_slot">NOME</div>
      <div id="guideNameSlot" data-i18n="guia_name_slot">GUIA</div>
    </div>
  </div>
  <div class="footer-actions">
    <button id="previewBtn" class="btn" data-action="preview">Pré-visualizar</button>
    <button id="captureBtn" class="btn" data-action="capture">Capturar</button>
    <button id="btnSkipSelfie" class="btn" data-action="skip-selfie" data-i18n="skip_selfie_button">Pular Selfie</button>
    <button class="btn btn-avancar" data-action="avancar" disabled data-i18n="avancar_button">Avançar</button>
  </div>
</div>

<!-- FILME: filme-1-entrando-na-jornada -->
<div id="section-filme-entrando" class="j-section hidden">
  <video id="video-entrando" autoplay>
    <source src="/assets/img/filme-1-entrando-na-jornada.mp4" type="video/mp4">
    Seu navegador não suporta vídeo.
  </video>
  <div class="footer-actions">
    <button class="btn btn-avancar" data-action="avancar" data-i18n="avancar_button">Avançar</button>
  </div>
</div>

<!-- PERGUNTAS -->
<div id="section-perguntas" class="j-section hidden">
  <div class="content">
    <div id="bloco-raizes" class="bloco-perguntas">
      <h2 id="raizes-title" data-typing="true" data-text="Block 1 — Roots" data-speed="40" data-cursor="true"></h2>
      <div class="pergunta">
        <label for="quem_voce_hoje" data-i18n="pergunta_quem_voce_hoje" data-typing="true" data-speed="36" data-cursor="true">Who are you today?</label>
        <textarea id="quem_voce_hoje"></textarea>
      </div>
      <div class="pergunta">
        <label for="o_que_te_trouxe" data-i18n="pergunta_o_que_te_trouxe" data-typing="true" data-speed="36" data-cursor="true">What brought you to this journey?</label>
        <textarea id="o_que_te_trouxe"></textarea>
      </div>
      <div class="pergunta">
        <label for="sonho_espiritual" data-i18n="pergunta_sonho_espiritual" data-typing="true" data-speed="36" data-cursor="true">What is your greatest spiritual dream?</label>
        <textarea id="sonho_espiritual"></textarea>
      </div>
    </div>
    <div id="bloco-reflexoes" class="bloco-perguntas hidden">
      <h2 id="reflexoes-title" data-typing="true" data-text="Block 2 — Reflections" data-speed="40" data-cursor="true"></h2>
      <div class="pergunta">
        <label for="desafios_atuais" data-i18n="pergunta_desafios_atuais" data-typing="true" data-speed="36" data-cursor="true">What are your biggest current challenges?</label>
        <textarea id="desafios_atuais"></textarea>
      </div>
      <div class="pergunta">
        <label for="medo_duvida" data-i18n="pergunta_medo_duvida" data-typing="true" data-speed="36" data-cursor="true">How do you deal with fear or doubt?</label>
        <textarea id="medo_duvida"></textarea>
      </div>
      <div class="pergunta">
        <label for="significado_luz" data-i18n="pergunta_significado_luz" data-typing="true" data-speed="36" data-cursor="true">What does "light" mean to you?</label>
        <textarea id="significado_luz"></textarea>
      </div>
    </div>
    <div id="bloco-crescimento" class="bloco-perguntas hidden">
      <h2 id="crescimento-title" data-typing="true" data-text="Block 3 — Growth" data-speed="40" data-cursor="true"></h2>
      <div class="pergunta">
        <label for="mudar_vida" data-i18n="pergunta_mudar_vida" data-typing="true" data-speed="36" data-cursor="true">What do you want to change in your life?</label>
        <textarea id="mudar_vida"></textarea>
      </div>
      <div class="pergunta">
        <label for="quem_inspira" data-i18n="pergunta_quem_inspira" data-typing="true" data-speed="36" data-cursor="true">Who inspires you and why?</label>
        <textarea id="quem_inspira"></textarea>
      </div>
      <div class="pergunta">
        <label for="pratica_gratidao" data-i18n="pergunta_pratica_gratidao" data-typing="true" data-speed="36" data-cursor="true">How do you practice gratitude daily?</label>
        <textarea id="pratica_gratidao"></textarea>
      </div>
    </div>
    <div id="bloco-integracao" class="bloco-perguntas hidden">
      <h2 id="integracao-title" data-typing="true" data-text="Block 4 — Integration" data-speed="40" data-cursor="true"></h2>
      <div class="pergunta">
        <label for="licao_jornada" data-i18n="pergunta_licao_jornada" data-typing="true" data-speed="36" data-cursor="true">What lesson do you take from this journey?</label>
        <textarea id="licao_jornada"></textarea>
      </div>
      <div class="pergunta">
        <label for="aplicar_futuro" data-i18n="pergunta_aplicar_futuro" data-typing="true" data-speed="36" data-cursor="true">How will you apply this in the future?</label>
        <textarea id="aplicar_futuro"></textarea>
      </div>
      <div class="pergunta">
        <label for="mensagem_futuro" data-i18n="pergunta_mensagem_futuro" data-typing="true" data-speed="36" data-cursor="true">A message for your future self.</label>
        <textarea id="mensagem_futuro"></textarea>
      </div>
    </div>
    <div id="bloco-sintese" class="bloco-perguntas hidden">
      <h2 id="sintese-title" data-typing="true" data-text="Block 5 — Synthesis and Delivery" data-speed="40" data-cursor="true"></h2>
      <div class="pergunta">
        <label for="essencia_hoje" data-i18n="pergunta_essencia_hoje" data-typing="true" data-speed="36" data-cursor="true">Who are you today, in one true sentence?</label>
        <textarea id="essencia_hoje"></textarea>
      </div>
      <div class="pergunta">
        <label for="passo_fe" data-i18n="pergunta_passo_fe" data-typing="true" data-speed="36" data-cursor="true">What will be your next step of faith and courage?</label>
        <textarea id="passo_fe"></textarea>
      </div>
    </div>
    <div class="footer-actions">
      <button class="btn btn-avancar" data-action="avancar">Avançar</button>
    </div>
  </div>
</div>

<!-- FINAL -->
<div id="section-final" class="j-section hidden">
  <div class="content">
    <p id="final-text" data-typing="true" data-text="Parabéns por completar a jornada!" data-speed="40" data-cursor="true"></p>
  </div>
  <div class="footer-actions">
    <button class="btn btn-avancar" data-action="avancar">Finalizar</button>
  </div>
</div>

  <footer class="site-footer">
    <small>© 2025 Irmandade Conhecimento com Luz</small>
    <div id="envTag" style="margin-top:6px;opacity:.6;font-size:18px;"></div>
  </footer>

  <!-- Vídeo overlay -->
  <div id="videoOverlay" class="hidden">
    <video id="videoTransicao" class="video-player" playsinline controls></video>
    <div id="videoFallback" class="video-fallback hidden">Áudio da jornada em reprodução. Converta para H.264 MP4.</div>
    <button id="skipVideo" class="btn" style="position:absolute; top:14px; right:14px">Pular vídeo</button>
  </div>

  <!-- Chama inferior -->
  <div id="flame-bottom-right" class="flame-corner flame-bottom-right">
    <div class="chama-vela chama-md">
      <div class="brasa"></div><div class="lingua"></div><div class="lingua"></div><div class="lingua"></div><div class="brilho"></div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" role="status" aria-live="polite" class="hidden"></div>

 <!-- Utils --> 
<script>
(function() {
  window.utils = window.utils || {};
  window.utils.dedupe = window.utils.dedupe || (str => str ? String(str).replace(/\s+/g, ' ').trim() : '');
  console.log('[Utils] Bloco carregado');
})();
</script>
        
<!-- Toast -->
  <script>
(function() {
  window.toast = function(msg, time = 3000) {
    const t = document.getElementById('toast');
    if (!t) {
      console.log('[Toast] Mensagem:', msg);
      return;
    }
    t.textContent = msg;
    t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), time);
  };
  console.log('[Toast] Bloco carregado');
})();
</script>

  <!-- TTS -->
  <script>
(function() {
  if (!window.JORNADA) window.JORNADA = {};
  window.JORNADA.tts = window.JORNADA.tts || { enabled: true, readingMode: 'after' };
  window.isMuted = window.isMuted || false;
  console.log('[TTS] Bloco carregado');
})();
</script>

 <!-- Senha -->
<script>
(function() {
  const log = (...a) => { try { console.log('[Senha v4]', ...a); } catch (_) {} };
  const VALID_PASSWORD = 'luz123';

  function getSenhaSection() {
    return document.getElementById('section-senha') || document.querySelector('[data-section="senha"], .section-senha') || document;
  }

  function getSenhaInput() {
    const root = getSenhaSection();
    const tries = [
      '#senhaInput', '#iniciar', 'input[data-role="senha"]', 'input[name="senha"]',
      'input[name*="senha" i]', 'input[id*="senha" i]', 'input[type="password"]',
      'input[type="text"][name*="senha" i]', 'input[type="text"][id*="senha" i]',
      '.senha input', '.senha-input'
    ];
    for (const sel of tries) {
      const el = root.querySelector(sel);
      if (el) return el;
    }
    return root.querySelector('input');
  }

  window.toggleSenha = function() {
    const input = getSenhaInput();
    if (!input) {
      log('[Senha] input não encontrado');
      window.toast && window.toast('Campo de senha não encontrado.');
      return;
    }
    input.type = (input.type === 'password' ? 'text' : 'password');
    const eye = getSenhaSection().querySelector('[data-action="toggle-password"]');
    if (eye) {
      eye.classList.toggle('on');
      log('[Senha] Visibilidade da senha alternada');
    } else {
      log('[Senha] Olho mágico não encontrado');
      window.toast && window.toast('Botão de visibilidade não encontrado.');
    }
  };

  let lastStartJourney = 0;
  window.startJourney = function() {
    const now = performance.now();
    if (now - lastStartJourney < 1000) {
      log('[startJourney] Debounce: evitando chamada repetida');
      return;
    }
    lastStartJourney = now;

    const inputSenha = getSenhaInput();
    const inputNome = getSenhaSection().querySelector('#nameInput, [data-role="nome"], input[name="nome"]');
    const senha = (inputSenha && inputSenha.value || '').trim().toLowerCase();
    const nome = (inputNome && inputNome.value || '').trim();

    log('[startJourney] Senha fornecida:', senha ? '[oculta]' : 'nenhum', 'Nome:', nome || 'nenhum');

    if (!senha) {
      window.toast && window.toast('Digite a senha para continuar.');
      if (inputSenha) inputSenha.focus();
      log('[startJourney] Senha não fornecida');
      return;
    }

    if (senha !== VALID_PASSWORD) {
      window.toast && window.toast('Senha incorreta. Tente novamente.');
      if (inputSenha) inputSenha.focus();
      log('[startJourney] Senha inválida:', senha);
      return;
    }

    if (nome) {
      try { localStorage.setItem('JORNADA_NOME', nome); } catch (_) {}
    }

    if (window.JC) {
      document.addEventListener('allTypingComplete', () => {
        speechSynthesis.cancel();
        const videos = document.querySelectorAll('video');
        videos.forEach(video => {
          video.pause();
          video.src = '';
          video.load();
        });
        window.JC.goNext(); // Usa goNext para pular seções inexistentes
        log('[startJourney] Navegação para próxima seção após digitação');
      }, { once: true });
    } else {
      console.error('[startJourney] window.JC não definido');
      window.toast && window.toast('Erro ao inicializar jornada. Tente recarregar a página.');
    }
  };
  console.log('[Senha] Bloco carregado');
})();
</script>

  <!-- Guia Seleção -->
<script>
(function() {
  window.JORNADA = window.JORNADA || {};
  window.JORNADA.selectedGuia = window.JORNADA.selectedGuia || null;

  document.addEventListener('click', (e) => {
    const btn = e.target.closest('[data-action="select-guia"]');
    if (btn) {
      e.preventDefault();
      const guia = btn.dataset.guia;
      window.JORNADA.selectedGuia = guia;
      console.log('[Guia] Guia selecionado:', guia);
      const guideBg = document.getElementById('guideBg');
      if (guideBg) {
        guideBg.src = `/assets/img/irmandade-quarteto-bg-${guia}.png`;
      }
      const guideNameSlot = document.getElementById('guideNameSlot');
      if (guideNameSlot) {
        guideNameSlot.textContent = guia.charAt(0).toUpperCase() + guia.slice(1);
      }
      if (window.JC) {
        document.addEventListener('allTypingComplete', () => {
          speechSynthesis.cancel();
          const videos = document.querySelectorAll('video');
          videos.forEach(video => {
            video.pause();
            video.src = '';
            video.load();
          });
          window.JC.goNext();
          console.log('[Guia] Navegação para próxima seção após digitação');
        }, { once: true });
      } else {
        console.error('[Guia] window.JC não definido');
        window.toast && window.toast('Erro ao navegar para próxima seção.');
      }
    }
  });
  console.log('[Guia] Bloco carregado');
})();
</script>

  <!-- Selfie -->
<script>
(function() {
  let lastPreview = 0;
  let lastCapture = 0;

  document.addEventListener('change', (e) => {
    const input = e.target.closest('#selfieInput');
    if (input && input.files && input.files[0]) {
      const reader = new FileReader();
      reader.onload = (ev) => {
        const img = document.getElementById('selfieImage');
        if (img) {
          img.setAttribute('href', ev.target.result);
          document.querySelector('.flame-layer').style.opacity = '1';
          console.log('[Selfie] Imagem carregada');
        }
      };
      reader.readAsDataURL(input.files[0]);
    }
  });

  document.addEventListener('input', (e) => {
    const input = e.target.closest('#nameInput, #selfieScale, #selfieOffsetX, #selfieOffsetY');
    if (input) {
      const img = document.getElementById('selfieImage');
      const nameSlot = document.getElementById('userNameSlot');
      if (!img || !nameSlot) return;

      if (input.id === 'nameInput') {
        nameSlot.textContent = input.value || 'NOME';
      } else {
        const scale = document.getElementById('selfieScale')?.value || 1;
        const offsetX = document.getElementById('selfieOffsetX')?.value || 0;
        const offsetY = document.getElementById('selfieOffsetY')?.value || 0;
        img.style.transform = `scale(${scale}) translate(${offsetX}px, ${offsetY}px)`;
      }
      console.log('[Selfie] Ajustes aplicados');
    }
  });

  document.addEventListener('click', (e) => {
    const btn = e.target.closest('#previewBtn, #captureBtn, #btnSkipSelfie, #btnStartJourney');
    if (btn) {
      e.preventDefault();
      const now = performance.now();
      if (btn.id === 'previewBtn') {
        if (now - lastPreview < 1000) return;
        lastPreview = now;
        const img = document.getElementById('selfieImage');
        if (img && img.getAttribute('href')) {
          document.querySelector('.flame-layer').style.opacity = '1';
          window.toast && window.toast('Pré-visualização atualizada!');
          console.log('[Selfie] Pré-visualização atualizada');
        } else {
          window.toast && window.toast('Selecione uma imagem primeiro.');
          console.log('[Selfie] Nenhuma imagem selecionada para pré-visualização');
        }
      } else if (btn.id === 'captureBtn') {
        if (now - lastCapture < 1000) return;
        lastCapture = now;
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        const img = document.getElementById('selfieImage');
        const bg = document.getElementById('guideBg');
        const nameSlot = document.getElementById('userNameSlot');
        const guideNameSlot = document.getElementById('guideNameSlot');
        if (!img || !bg || !nameSlot || !guideNameSlot) {
          window.toast && window.toast('Erro ao capturar imagem.');
          console.log('[Selfie] Elementos de imagem, fundo ou nomes não encontrados');
          return;
        }
        canvas.width = bg.width;
        canvas.height = bg.height;
        ctx.drawImage(bg, 0, 0, canvas.width, canvas.height);
        const scale = document.getElementById('selfieScale')?.value || 1;
        const offsetX = document.getElementById('selfieOffsetX')?.value || 0;
        const offsetY = document.getElementById('selfieOffsetY')?.value || 0;
        ctx.save();
        ctx.translate(15 + parseFloat(offsetX), 35 + parseFloat(offsetY));
        ctx.scale(scale, scale);
        ctx.drawImage(img, 0, 0, 70, 90);
        ctx.restore();
        ctx.font = 'bold 2.5rem Cardo, serif';
        ctx.fillStyle = '#f7d37a';
        ctx.textAlign = 'center';
        ctx.fillText(guideNameSlot.textContent, canvas.width / 2, canvas.height * 0.02 + 30);
        ctx.font = 'bold 2rem Cardo, serif';
        ctx.fillText(nameSlot.textContent, canvas.width / 2, canvas.height * 0.98 - 10);
        const link = document.createElement('a');
        link.download = 'selfie-irmandade.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
        console.log('[Selfie] Imagem baixada');
        try {
          localStorage.setItem('JORNADA_SELFIE', link.href);
        } catch (_) {}
      } else if (btn.id === 'btnSkipSelfie' || btn.id === 'btnStartJourney') {
        if (window.JC) {
          document.addEventListener('allTypingComplete', () => {
            speechSynthesis.cancel();
            const videos = document.querySelectorAll('video');
            videos.forEach(video => {
              video.pause();
              video.src = '';
              video.load();
            });
            window.JC.goNext();
            console.log('[Selfie] Navegação para próxima seção após digitação');
          }, { once: true });
        } else {
          console.error('[Selfie] window.JC não definido');
          window.toast && window.toast('Erro ao navegar para próxima seção.');
        }
      }
    }
  });
  console.log('[Selfie] Bloco carregado');
})();
</script>
  

</body>
</html>
