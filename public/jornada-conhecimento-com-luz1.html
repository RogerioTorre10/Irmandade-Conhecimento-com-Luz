<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Jornada • Irmandade Conhecimento com Luz</title>
  <link rel="stylesheet" href="/styles.css">
  <link rel="alternate icon" href="/assets/img/perfil-da-irmandade.png" type="image/png">
  <link rel="stylesheet" href="/css/chama.css">
  <style>
    .pergaminho { background: #f6efe0 !important; }
    .pergaminho-v {
      background-image: url('/assets/img/pergaminho-rasgado-vert.png') !important;
      background-size: cover !important;
      background-position: center !important;
      min-height: 82vh !important;
    }
    .pergaminho-h {
      background-image: url('/assets/img/pergaminho-rasgado-horiz.png') !important;
      background-size: cover !important;
      background-position: center !important;
      min-height: 82vh !important;
    }
    #jornada-canvas {
      position: relative;
      z-index: 1;
      background: transparent !important;
    }
    #jornada-conteudo {
      background: transparent !important;
      position: relative;
      z-index: 2;
      padding: 20px;
    }
    .j-bloco {
      background: transparent !important;
      padding: 20px;
    }
  </style>
</head>

<body data-layout="master" data-journey="essencial">
  <header class="site-header flex items-center gap-3">
    <div class="chama chama-sm">
      <span></span><span></span><span></span>
    </div>
    <h1>Jornada Essencial</h1>
  </header>

  <main id="page-shell" class="container">
    <header class="site-header">
      <h1>Jornada Essencial</h1>
      <p id="status">Orientações e Termo de Responsabilidade da Jornada.</p>
    </header>
    <div class="container">
      <a class="btn btn-primary" href="#intro">Ir para Introdução</a>
      <a class="btn" href="/jornadas.html">← Voltar</a>
    </div>
    <main class="container">
      <section id="jornada-canvas" class="card pergaminho pergaminho-v">
        <div id="jornada-conteudo" class="conteudo-pergaminho"></div>
      </section>
    </main>
    <footer class="site-footer">
      <small>© 2025 Irmandade Conhecimento com Luz</small>
    </footer>
  </main>

  <div class="progress-badge" id="jprog-pct">0% concluído</div>
  <div class="progress-bar"><div class="progress-bar-fill" id="jprog-fill"></div></div>

  <div id="jornada-conteudo-intro" class="conteudo-pergaminho">
    <p data-typing data-text="Respire. Esta jornada é sua. Um passo de cada vez." data-speed="40" data-cursor="true"></p>
    <p data-typing data-text="Bem-vindo(a) à nossa casa de reflexão e coragem. Aqui, fé e consciência se unem para acender sua chama interior — passo a passo, jornada por jornada." data-speed="50" data-cursor="true"></p>
  </div>

  <div class="j-progress" style="margin-top:12px">
    <div class="j-progress__bar"><div class="j-progress__fill"></div></div>
    <div class="j-progress__meta" id="j-meta"></div>
  </div>

  <div class="footer-actions" style="margin:10px 0 16px">
    <button id="btnPrev" class="btn btn-secondary" data-action="prev">Voltar</button>
    <button id="btnNext" class="btn btn-primary" data-action="next">Próxima</button>
  </div>

  <section class="j-bloco" data-bloco="0" data-video="/assets/img/filme-1-entrando-na-jornada.mp4" data-pergaminho-h>
    <div class="j-pergunta" data-pergunta="0">
      <label class="pergunta-enunciado" data-type="Pergunta 1: Quem é você neste momento da vida?"><b>Pergunta 1:</b> Quem é você neste momento da vida?</label>
      <textarea rows="4" class="input" placeholder="Digite sua resposta..."></textarea>
    </div>
    <div class="j-pergunta" data-pergunta="1">
      <label class="pergunta-enunciado" data-type="Pergunta 2: O que te move hoje?"><b>Pergunta 2:</b> O que te move hoje?</label>
      <textarea rows="4" class="input" placeholder="Digite sua resposta..."></textarea>
    </div>
    <div class="j-pergunta" data-pergunta="2">
      <label class="pergunta-enunciado" data-type="Pergunta 3: Qual é o seu maior sonho agora?"><b>Pergunta 3:</b> Qual é o seu maior sonho agora?</label>
      <textarea rows="4" class="input" placeholder="Digite sua resposta..."></textarea>
    </div>
    <div class="j-pergunta" data-pergunta="3">
      <label class="pergunta-enunciado" data-type="Pergunta 4: O que te desafia hoje?"><b>Pergunta 4:</b> O que te desafia hoje?</label>
      <textarea rows="4" class="input" placeholder="Digite sua resposta..."></textarea>
    </div>
    <div class="j-pergunta" data-pergunta="4">
      <label class="pergunta-enunciado" data-type="Pergunta 5: Como você se vê em um ano?"><b>Pergunta 5:</b> Como você se vê em um ano?</label>
      <textarea rows="4" class="input" placeholder="Digite sua resposta..."></textarea>
    </div>
  </section>

  <section class="j-bloco" data-bloco="1" data-video="/assets/img/filme-2-dentro-da-jornada.mp4" data-pergaminho-h>
    <div class="j-pergunta" data-pergunta="0">
      <label class="pergunta-enunciado"><b>Pergunta 1:</b> O que significa fé pra você hoje?</label>
      <textarea rows="4" class="input"></textarea>
    </div>
    <div class="j-pergunta" data-pergunta="1">
      <label class="pergunta-enunciado"><b>Pergunta 2:</b> Onde você percebe luz no cotidiano?</label>
      <textarea rows="4" class="input"></textarea>
    </div>
    <div class="j-pergunta" data-pergunta="2">
      <label class="pergunta-enunciado"><b>Pergunta 3:</b> Qual hábito novo você quer firmar?</label>
      <textarea rows="4" class="input"></textarea>
    </div>
    <div class="j-pergunta" data-pergunta="3">
      <label class="pergunta-enunciado"><b>Pergunta 4:</b> Qual cuidado com o próximo você deseja praticar?</label>
      <textarea rows="4" class="input"></textarea>
    </div>
    <div class="j-pergunta" data-pergunta="4">
      <label class="pergunta-enunciado"><b>Pergunta 5:</b> Uma gratidão de hoje:</label>
      <textarea rows="4" class="input"></textarea>
    </div>
  </section>

  <div id="videoOverlay" class="video-overlay hidden">
    <video id="videoTransicao" playsinline preload="metadata" controls style="max-width:90vw; max-height:80vh; background:#000"></video>
    <button id="skipVideo" class="btn btn-secondary" style="position:absolute; top:14px; right:14px">Pular vídeo</button>
  </div>

  <script>
    (function () {
      if (typeof window.activateJornada === 'function') {
        try { window.activateJornada(); } 
        catch (e) { document.body.classList.add('jornada-active'); }
      } else {
        document.body.classList.add('jornada-active');
      }

      const route = (location.hash || '#intro').slice(1);

      if (typeof window.mount === 'function') {
        window.mount({ startAt: route });
        return;
      }

      if (!window.JORNADA_RENDER) {
        console.error('JORNADA_RENDER não disponível. Confira a ORDEM dos scripts.');
        return;
      }

      if (route === 'intro') {
        JORNADA_RENDER.renderIntro();
      } else if (route === 'perguntas') {
        JORNADA_RENDER.renderPerguntas(0);
      } else if (route === 'final') {
        JORNADA_RENDER.renderFinal();
      } else {
        JORNADA_RENDER.renderIntro();
      }
    })();
  </script>

  <footer style="opacity:.6; font-size:.85rem; margin-top:2rem; text-align:center">
    <span id="envTag"></span>
  </footer>
  <script>
    document.getElementById('envTag').textContent =
      `layout=${document.body.dataset.layout || 'master'} · journey=${document.body.dataset.journey || 'essencial'} · path=/public`;
  </script>
  <script>
    (function(){
      function typeWriter(el, text, speed, showCursor){
        if (!el) return;
        el.textContent = '';
        if (showCursor) el.classList.add('lumen-typing');
        let i = 0;
        (function step(){
          if (i < text.length){ el.textContent += text.charAt(i++); setTimeout(step, speed); }
          else { el.classList.add('typing-done'); }
        })();
      }
      function runTyping(root){
        (root || document).querySelectorAll('[data-typing]').forEach(el=>{
          if (el.dataset._typed) return;
          const t = el.getAttribute('data-text') || el.textContent || '';
          const spd = parseInt(el.getAttribute('data-speed') || '26', 10);
          const cur = String(el.getAttribute('data-cursor') || 'true') === 'true';
          el.dataset._typed = '1';
          typeWriter(el, t, spd, cur);
        });
      }
      document.addEventListener('DOMContentLoaded', ()=>runTyping(document));
      const target = document.getElementById('jornada-conteudo');
      if (target) {
        const obs = new MutationObserver(muts => {
          console.log('Mudanças em #jornada-conteudo:', muts);
          muts.forEach(m => runTyping(m.target));
        });
        obs.observe(target, { childList: true, subtree: true });
      }
    })();
  </script>
  <style>
    .lumen-typing { white-space: pre-wrap; position: relative; }
    .lumen-typing::after { content: "▌"; margin-left: 2px; opacity: .75; animation: lumenBlink 1s steps(2, end) infinite; }
    .lumen-typing.typing-done::after { content: ""; animation: none; }
    @keyframes lumenBlink { 50% { opacity: 0; } }
  </style>
  <script defer src="/config.js"></script>
  <script defer src="/jornada-utils.js"></script>
  <script defer src="/jornada-core.js"></script>
  <script defer src="/jornada-auth.js"></script>
  <script defer src="/jornada-chama.js"></script>
  <script defer src="/jornada-paper-qa.js"></script>
  <script defer src="/jornada-typing-font.js"></script>
  <script defer src="/i18n/i18n.js"></script>
  <script defer src="/jornada-micro.js"></script>
  <script defer src="/jornada-typing.js"></script>
  <script defer src="/jornada-controller.js"></script>
  <script defer src="/jornada-render.js"></script>
  <script defer src="/jornada-bootstrap.js"></script>
  <script>
    (function () {
      function boot() {
        if (window.JORNADA_RENDER?.renderIntro) {
          document.body.classList.add('jornada-active');
          const route = (location.hash || '#intro').slice(1);
          if (route === 'perguntas') JORNADA_RENDER.renderPerguntas(0);
          else if (route === 'final') JORNADA_RENDER.renderFinal();
          else JORNADA_RENDER.renderIntro();
          return true;
        }
        return false;
      }
      if (!boot()) {
        let tries = 0; const timer = setInterval(() => {
          if (boot() || ++tries > 40) clearInterval(timer);
        }, 100);
      }
    })();
  </script>
</body>
</html>
