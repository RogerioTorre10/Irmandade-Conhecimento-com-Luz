<!DOCTYPE html>
<html lang="pt-br">
<head>
Â  <meta charset="utf-8">
Â  <meta name="viewport" content="width=device-width, initial-scale=1">
Â  <title>Jornada â€¢ Irmandade Conhecimento com Luz</title>
Â  <link rel="alternate icon" href="/assets/img/perfil-da-irmandade.png" type="image/png">

Â  <style>
Â  Â  /* ===== BASE ===== */
Â  Â  body { margin:0; font-family: Arial, sans-serif; background:#f9f9f9; color:#333; }
Â  Â  .site-header{display:flex;align-items:center;gap:12px;padding:16px;background:#1f2937;color:#fff;box-shadow:0 2px 4px rgba(0,0,0,.1);position:relative;z-index:1000}
Â  Â  .container{max-width:900px;margin:24px auto;padding:0 16px}
Â  Â  .card{background:#f6efe0!important;border-radius:14px;box-shadow:0 8px 28px rgba(0,0,0,.12);padding:32px;position:relative;z-index:10}

Â  Â  /* ===== PERGAMINHO ===== */
Â  Â  .pergaminho-v{background-image:url('/assets/img/pergaminho-rasgado-vert.png')!important;background-size:cover!important;background-position:center!important;min-height:82vh!important}
Â  Â  .pergaminho-h{background-image:url('/assets/img/pergaminho-rasgado-horiz.png')!important;background-size:cover!important;background-position:center!important;min-height:82vh!important}
Â  Â  .pergaminho-h.fallback{background-image:url('/assets/img/pergaminho-rasgado-vert.png')!important}
Â  Â  .conteudo-pergaminho{background:transparent!important;position:relative;z-index:20;padding:20px;min-height:100%;overflow:visible}

Â  Â  /* ===== CHAMA - NOVO ESTILO DE VELA ===== */
Â  Â  .chama-viva {
Â  Â  Â  --altura: 90px;
Â  Â  Â  --largura: 60px;
Â  Â  Â  --pulso: 1.8s;
Â  Â  Â  --glow: 16px;
Â  Â  Â  --hue: 32;
Â  Â  Â  --satur: 95%;
Â  Â  Â  --light: 58%;
Â  Â  Â  --op: .95;

Â  Â  Â  position: relative;
Â  Â  Â  width: var(--largura);
Â  Â  Â  height: calc(var(--altura) + 26px);
Â  Â  Â  display: inline-block;
Â  Â  Â  filter: drop-shadow(0 0 var(--glow) hsla(var(--hue),var(--satur),60%,.65));
Â  Â  Â  z-index: 40;
Â  Â  }
Â  Â  .chama-viva::after {
Â  Â  Â  content:"";
Â  Â  Â  position:absolute; left:50%; bottom:0; transform:translateX(-50%);
Â  Â  Â  width: calc(var(--largura) * 1.25);
Â  Â  Â  height: 26px;
Â  Â  Â  background:
Â  Â  Â  Â  radial-gradient(120% 100% at 50% 0%, rgba(0,0,0,.15) 0%, rgba(0,0,0,.25) 55%, rgba(0,0,0,.35) 100%);
Â  Â  Â  border-radius: 0 0 18px 18px;
Â  Â  Â  box-shadow:
Â  Â  Â  Â  inset 0 6px 10px rgba(255,255,255,.12), inset 0 -6px 10px rgba(0,0,0,.35);
Â  Â  }
Â  Â  .chama-viva .brasa {
Â  Â  Â  position:absolute; left:50%; bottom:18px; transform:translateX(-50%);
Â  Â  Â  width: calc(var(--largura) * .9);
Â  Â  Â  height: 16px;
Â  Â  Â  border-radius: 50%;
Â  Â  Â  background:
Â  Â  Â  Â  radial-gradient(circle at 50% 40%, hsla(var(--hue),var(--satur),95%,.9) 0%, hsla(var(--hue),var(--satur),70%,.8) 35%, hsla(var(--hue),var(--satur),40%,.0) 70%);
Â  Â  Â  filter: blur(1.5px);
Â  Â  Â  animation: brasaPulse var(--pulso) infinite ease-in-out;
Â  Â  Â  opacity: var(--op);
Â  Â  }
Â  Â  .chama-viva .lingua {
Â  Â  Â  position:absolute; left:50%; bottom:18px; transform:translateX(-50%);
Â  Â  Â  width: var(--largura);
Â  Â  Â  height: var(--altura);
Â  Â  Â  border-radius: 44% 44% 30% 30%;
Â  Â  Â  background:
Â  Â  Â  Â  radial-gradient(60% 60% at 50% 28%, hsla(var(--hue),var(--satur),98%,1) 0%, hsla(var(--hue),var(--satur),70%,.95) 35%, hsla(calc(var(--hue) - 8),calc(var(--satur) - 15%),50%,.85) 65%, transparent 82%);
Â  Â  Â  mix-blend-mode: screen;
Â  Â  Â  filter: blur(0.6px);
Â  Â  Â  animation: lingua 1.2s infinite ease-in-out;
Â  Â  Â  transform-origin: 50% 100%;
Â  Â  Â  opacity: var(--op);
Â  Â  }
Â  Â  .chama-viva .lingua:nth-child(2) {
Â  Â  Â  width: calc(var(--largura) * .78);
Â  Â  Â  height: calc(var(--altura) * .88);
Â  Â  Â  animation-duration: 1.5s;
Â  Â  Â  animation-delay:.05s;
Â  Â  }
Â  Â  .chama-viva .lingua:nth-child(3) {
Â  Â  Â  width: calc(var(--largura) * .62);
Â  Â  Â  height: calc(var(--altura) * .76);
Â  Â  Â  animation-duration: 1.8s;
Â  Â  Â  animation-delay:.12s;
Â  Â  }
Â  Â  .chama-viva .brilho {
Â  Â  Â  position:absolute; left:50%; bottom:16px; transform:translateX(-50%);
Â  Â  Â  width: calc(var(--largura) * 1.3);
Â  Â  Â  height: calc(var(--altura) * 1.1);
Â  Â  Â  background: radial-gradient(circle, hsla(var(--hue),var(--satur),70%,.35) 0%, transparent 65%);
Â  Â  Â  filter: blur(12px);
Â  Â  Â  pointer-events:none;
Â  Â  Â  mix-blend-mode: screen;
Â  Â  Â  animation: aura var(--pulso) infinite ease-in-out;
Â  Â  Â  opacity: .6;
Â  Â  }

Â  Â  /* AdaptaÃ§Ã£o para tamanhos */
Â  Â  .chama.chama-sm { width:32px; height:64px; }
Â  Â  .chama.chama-md { width:48px; height:96px; }
Â  Â  .chama.chama-lg { width:60px; height:120px; }
Â  Â  .chama.chama-sm .brasa { width: calc(var(--largura) * .7); height: 10px; bottom:12px; }
Â  Â  .chama.chama-md .brasa { width: calc(var(--largura) * .9); height: 16px; bottom:18px; }
Â  Â  .chama.chama-lg .brasa { width: calc(var(--largura) * .9); height: 20px; bottom:22px; }
Â  Â  .chama-viva.chama-sm { --altura: 60px; --largura: 32px; }
Â  Â  .chama-viva.chama-md { --altura: 90px; --largura: 48px; }
Â  Â  .chama-viva.chama-lg { --altura: 110px; --largura: 60px; }

Â  Â  /* AnimaÃ§Ãµes da chama */
Â  Â  @keyframes lingua {
Â  Â  Â  0%,100% { transform: translateX(-50%) scaleY(1) skewX(0deg); }
Â  Â  Â  50% { transform: translateX(-50%) scaleY(1.06) skewX(1.2deg); }
Â  Â  }
Â  Â  @keyframes brasaPulse {
Â  Â  Â  0%,100% { transform:translateX(-50%) scale(1); opacity:.7; }
Â  Â  Â  50% { transform:translateX(-50%) scale(1.05); opacity:1; }
Â  Â  }
Â  Â  @keyframes aura {
Â  Â  Â  0%,100% { opacity:.5; }
Â  Â  Â  50% { opacity:.8; }
Â  Â  }
Â  Â  @keyframes linguaJitter {
Â  Â  Â  0%, 100% { transform: translateX(-50%) scaleY(1) skewX(0deg); } 20% { transform: translateX(-50%) scaleY(1.05) skewX(.5deg); } 50% { transform: translateX(-50%) scaleY(1.1) skewX(1.2deg); } 80% { transform: translateX(-50%) scaleY(1.03) skewX(.3deg); }
Â  Â  }
Â  Â  @keyframes brilhoJitter {
Â  Â  Â  0%, 100% { filter: blur(12px); } 50% { filter: blur(14px); }
Â  Â  }

Â  Â  /* Modos emocionais */
Â  Â  .chama-viva[data-intensidade="fraca"] {
Â  Â  Â  --altura: 70px; --largura: 52px; --pulso: 2.8s; --glow: 8px;
Â  Â  Â  --hue: 40; --satur: 80%; --light: 65%; --op: .65;
Â  Â  }
Â  Â  .chama-viva[data-intensidade="media"] {
Â  Â  Â  --altura: 90px; --largura: 60px; --pulso: 1.8s; --glow: 16px;
Â  Â  Â  --hue: 32; --satur: 95%; --light: 58%; --op: .95;
Â  Â  }
Â  Â  .chama-viva[data-intensidade="forte"] {
Â  Â  Â  --altura: 110px; --largura: 66px; --pulso: 1.1s; --glow: 26px;
Â  Â  Â  --hue: 20; --satur: 100%; --light: 52%; --op: 1;
Â  Â  }
Â  Â  .chama-viva.chama-pico .lingua {
Â  Â  Â  animation-timing-function: ease-out;
Â  Â  Â  transform: translateX(-50%) scaleY(1.1) skewX(1.6deg);
Â  Â  }

Â  Â  /* Outras classes e animaÃ§Ãµes preservadas */
Â  Â  .chama-fixed-top{position:absolute;top:10px;right:14px;z-index:60}
Â  Â  .chama-fixed-hero{position:absolute;top:-8px;left:-8px;z-index:60}
Â  Â  .mark-emocao{background:linear-gradient(90deg,rgba(255,196,0,.35),rgba(255,140,0,.2));border-radius:4px;padding:0 2px}
Â  Â  .btn{display:inline-block;padding:12px 24px;border-radius:10px;border:0;background:#1f2937;color:#fff;font-weight:600;text-decoration:none;transition:background .3s ease, transform .2s ease;z-index:30}
Â  Â  .btn:hover{background:#374151;transform:scale(1.05)}
Â  Â  .btn-primary{background:#6b21a8}
Â  Â  .btn-primary:hover{background:#7c3aed}
Â  Â  .btn-secondary{background:#4b5563}
Â  Â  .btn-secondary:hover{background:#6b7280}
Â  Â  .btn + .btn{margin-left:12px}
Â  Â  .progress-badge{position:fixed;top:16px;right:16px;padding:8px 16px;background:#6b21a8;color:#fff;border-radius:8px;font-size:.9rem;z-index:900;visibility:visible}
Â  Â  .progress-bar{width:100%;height:8px;background:#e5e7eb;border-radius:4px;margin-top:12px;z-index:900;visibility:visible}
Â  Â  .progress-bar-fill{height:100%;background:#6b21a8;border-radius:4px;transition:width .3s ease}
Â  Â  .j-progress{margin-top:12px;z-index:900;visibility:visible}
Â  Â  .j-progress__bar{width:100%;height:6px;background:#e5e7eb;border-radius:4px}
Â  Â  .j-progress__fill{height:100%;background:#1f2937;border-radius:4px;transition:width .3s ease}
Â  Â  .j-progress__meta{text-align:center;margin-top:8px;font-size:.9rem}
Â  Â  .footer-actions{display:flex;gap:12px;justify-content:center;margin:16px 0;z-index:900}
Â  Â  .lumen-typing{white-space:pre-wrap;position:relative}
Â  Â  .lumen-typing::after{content:"â–Œ";margin-left:2px;opacity:.75;animation:lumenBlink 1s steps(2,end) infinite}
Â  Â  .lumen-typing.typing-done::after{content:"";animation:none}
Â  Â  @keyframes lumenBlink{50%{opacity:0}}
Â  Â  .j-section{height:100%}
Â  Â  .j-bloco{background:transparent!important;display:none;z-index:50}
Â  Â  .j-pergunta{margin-bottom:24px;display:none;z-index:60;position:relative}
Â  Â  .j-pergunta.active{display:block}
Â  Â  .pergunta-enunciado{font-weight:600;margin-bottom:8px;display:block}
Â  Â  .j-pergunta textarea{width:100%;padding:12px;border-radius:8px;border:1px solid #d1d5db;background:rgba(255,255,255,.8);resize:vertical;min-height:100px}
Â  Â  #videoOverlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.8);display:flex;justify-content:center;align-items:center;z-index:2000}
Â  Â  #videoOverlay.hidden{display:none}
Â  Â  .video-player{max-width:90vw;max-height:80vh;background:#000}
Â  Â  .site-footer{text-align:center;padding:16px;opacity:.6;font-size:.85rem;z-index:10}
Â  Â  .password-form{margin-top:20px;text-align:center}
Â  Â  .password-input{position:relative}
Â  Â  .password-input input{width:100%;padding:12px;border-radius:8px;border:1px solid #d1d5db}
Â  Â  .password-toggle{position:absolute;right:10px;top:50%;transform:translateY(-50%);cursor:pointer}
Â  Â  .section-container{position:relative;min-height:85vh}
Â  Â  .hidden{display:none!important}
Â  Â  @media (max-width:600px) {
Â  Â  Â  .card { margin:16px; padding:20px }
Â  Â  Â  .site-header h1 { font-size:1.6rem }
Â  Â  Â  .btn { padding:10px 16px; font-size:.9rem }
Â  Â  Â  .chama-viva.chama-sm { --altura: 60px; --largura: 28px; }
Â  Â  Â  .chama-viva.chama-md { --altura: 80px; --largura: 38px; }
Â  Â  Â  .chama-viva.chama-lg { --altura: 100px; --largura: 50px; }
Â  Â  Â  .progress-badge { top:8px; right:8px; padding:6px 12px; font-size:.8rem }
Â  Â  }
Â  Â  @media (max-width:400px) {
Â  Â  Â  .chama-viva.chama-lg { --altura: 80px; --largura: 40px; }
Â  Â  Â  .btn { padding:8px 12px; font-size:.8rem }
Â  Â  Â  .card { padding:16px }
Â  Â  }
Â  </style>
</head>

<body data-layout="master" data-journey="essencial">
Â  <header class="site-header">
Â  Â  <div class="chama-viva chama-sm">
Â  Â  Â  <div class="brasa"></div>
Â  Â  Â  <div class="lingua"></div>
Â  Â  Â  <div class="lingua"></div>
Â  Â  Â  <div class="lingua"></div>
Â  Â  Â  <div class="brilho"></div>
Â  Â  </div>
Â  Â  <h1>Jornada Essencial</h1>
Â  </header>

Â  <main id="page-shell" class="container">
Â  Â  <div class="container">
Â  Â  Â  <a class="btn btn-primary" href="#intro">Ir para IntroduÃ§Ã£o</a>
Â  Â  Â  <a class="btn btn-secondary" href="/jornadas.html">â† Voltar</a>
Â  Â  </div>

Â  Â  <div class="section-container">
Â  Â  Â  <section id="jornada-canvas" class="card pergaminho pergaminho-v">
Â  Â  Â  Â  <div id="jornada-conteudo" class="conteudo-pergaminho">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="section-intro" class="j-section">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p data-typing data-text="Respire. Esta jornada Ã© sua. Um passo de cada vez." data-speed="40" data-cursor="true"></p>
Â  Â  Â  Â  Â  Â  <p data-typing data-text="Bem-vindo(a) Ã  nossa casa de reflexÃ£o e coragem. Antes de comeÃ§ar, ative sua senha." data-speed="50" data-cursor="true"></p>

Â  Â  Â  Â  Â  Â  <div class="password-form">
Â  Â  Â  Â  Â  Â  Â  <h3>Ative sua Senha</h3>
Â  Â  Â  Â  Â  Â  Â  <div class="password-input">
Â  Â  Â  Â  Â  Â  Â  Â  <input type="password" id="senha" placeholder="Digite sua senha...">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="password-toggle" data-action="toggle-password">ğŸ‘ï¸</span>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-primary" data-action="start">Ativar e Iniciar</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="section-perguntas" class="j-section hidden">
Â  Â  Â  Â  Â  Â  <div id="chama-perguntas" class="chama-viva chama-md">
Â  Â  Â  Â  Â  Â  Â  <div class="brasa"></div>
Â  Â  Â  Â  Â  Â  Â  <div class="lingua"></div>
Â  Â  Â  Â  Â  Â  Â  <div class="lingua"></div>
Â  Â  Â  Â  Â  Â  Â  <div class="lingua"></div>
Â  Â  Â  Â  Â  Â  Â  <div class="brilho"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div id="perguntas-container"></div>
Â  Â  Â  Â  Â  Â  <div class="footer-actions">
Â  Â  Â  Â  Â  Â  Â  <button id="btnPrevPerguntas" class="btn btn-secondary" data-action="prev">Voltar</button>
Â  Â  Â  Â  Â  Â  Â  <button id="btnNextPerguntas" class="btn btn-primary" data-action="next">PrÃ³xima</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="section-final" class="j-section hidden">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p data-typing data-text="ParabÃ©ns por completar esta jornada! Que sua chama interior continue a brilhar." data-speed="40" data-cursor="true"></p>
Â  Â  Â  Â  Â  Â  <div class="footer-actions">
Â  Â  Â  Â  Â  Â  Â  <button id="btnRestart" class="btn btn-secondary" data-action="restart">Reiniciar</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </section>
Â  Â  </div>

Â  Â  <footer class="site-footer">
Â  Â  Â  <small>Â© 2025 Irmandade Conhecimento com Luz</small>
Â  Â  Â  <div id="envTag"></div>
Â  Â  </footer>
Â  </main>

Â  Â  <div class="progress-badge" id="jprog-pct">0% concluÃ­do</div>
Â  <div class="progress-bar"><div class="progress-bar-fill" id="jprog-fill"></div></div>
Â  <div class="j-progress">
Â  Â  <div class="j-progress__bar"><div class="j-progress__fill"></div></div>
Â  Â  <div class="j-progress__meta" id="j-meta"></div>
Â  </div>

Â  Â  <div id="videoOverlay" class="video-overlay hidden">
Â  Â  <video id="videoTransicao" class="video-player" playsinline preload="metadata" controls></video>
Â  Â  <button id="skipVideo" class="btn btn-secondary" style="position:absolute; top:14px; right:14px">Pular vÃ­deo</button>
Â  </div>

Â  Â  <div id="guia-espiritual">
Â  Â  <div id="chama-bola" class="chama-viva chama-md">
Â  Â  Â  <div class="brasa"></div>
Â  Â  Â  <div class="lingua"></div>
Â  Â  Â  <div class="lingua"></div>
Â  Â  Â  <div class="lingua"></div>
Â  Â  Â  <div class="brilho"></div>
Â  Â  </div>
Â  </div>

Â  <script>
Â  Â  // Tag ambiente
Â  Â  document.getElementById('envTag').textContent =
Â  Â  Â  `layout=${document.body.dataset.layout || 'master'} Â· journey=${document.body.dataset.journey || 'essencial'} Â· path=/public`;

Â  Â  /* =========================
Â  Â  Â  Â EMOÃ‡ÃƒO & DATILOGRAFIA
Â  Â  ==========================*/
Â  Â  const EMO = {
Â  Â  Â  POS:{'feliz':2,'alegria':2,'amor':3,'sucesso':2,'esperanÃ§a':3,'paz':2,'fÃ©':3,'gratidÃ£o':2,'vitÃ³ria':3,'superaÃ§Ã£o':3,'luz':2,'deus':3,'coragem':2,'forÃ§a':2,'confianÃ§a':2,'propÃ³sito':3},
Â  Â  Â  NEG:{'triste':-2,'dor':-3,'raiva':-2,'medo':-2,'frustracao':-2,'frustraÃ§Ã£o':-2,'decepcao':-2,'decepÃ§Ã£o':-2,'perda':-3,'culpa':-2,'ansiedade':-2,'solidao':-2,'solidÃ£o':-2,'desespero':-3,'cansaco':-2,'cansaÃ§o':-2,'fracasso':-2,'trauma':-3,'duvida':-2,'dÃºvida':-2}
Â  Â  };
Â  Â  function analyzeSentiment(text){
Â  Â  Â  let score=0;
Â  Â  Â  const tokens=(text||'').toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').split(/\s+/);
Â  Â  Â  for(const t of tokens){ if(EMO.POS[t]!=null) score+=EMO.POS[t]; if(EMO.NEG[t]!=null) score+=EMO.NEG[t]; }
Â  Â  Â  return score;
Â  Â  }
Â  Â  function typeWriter(el,text,speed,showCursor){
Â  Â  Â  if(!el) return;
Â  Â  Â  el.textContent=''; if(showCursor) el.classList.add('lumen-typing');
Â  Â  Â  let i=0;(function step(){ if(i<text.length){ el.textContent+=text.charAt(i++); setTimeout(step,speed);} else{ el.classList.add('typing-done'); } })();
Â  Â  }
Â  Â  function runTyping(root){
Â  Â  Â  (root||document).querySelectorAll('[data-typing]').forEach(el=>{
Â  Â  Â  Â  if(el.dataset._typed) return;
Â  Â  Â  Â  const t=el.getAttribute('data-text')||el.textContent||'';
Â  Â  Â  Â  const spd=parseInt(el.getAttribute('data-speed')||'26',10);
Â  Â  Â  Â  const cur=String(el.getAttribute('data-cursor')||'true')==='true';
Â  Â  Â  Â  el.dataset._typed='1'; typeWriter(el,t,spd,cur);
Â  Â  Â  });
Â  Â  }

Â  Â  /* =========================
Â  Â  Â  Â CHAMA â€” API unificada (traz do arquivo 2)
Â  Â  ==========================*/
Â  Â  window.JORNADA_CHAMA = {
Â  Â  Â  updateChama(scoreNum, targetId='chama-perguntas'){
Â  Â  Â  Â  const el=document.getElementById(targetId); if(!el) return;
Â  Â  Â  Â  const modo = (scoreNum <= -2) ? 'fraca' : (scoreNum >= 2) ? 'forte' : 'media';
Â  Â  Â  Â  el.setAttribute('data-intensidade', modo);
Â  Â  Â  Â  // efeito pico
Â  Â  Â  Â  el.classList.add('chama-pico');
Â  Â  Â  Â  clearTimeout(el._pulse_t);
Â  Â  Â  Â  el._pulse_t=setTimeout(()=>el.classList.remove('chama-pico'),700);
Â  Â  Â  Â  // guia flutuante acompanha
Â  Â  Â  Â  const bola=document.getElementById('chama-bola');
Â  Â  Â  Â  if(bola){ bola.setAttribute('data-intensidade', modo); }
Â  Â  Â  },
Â  Â  Â  ensureHeroFlame(sectionId){
Â  Â  Â  Â  const canvas=document.getElementById('jornada-canvas'); if(!canvas) return;
Â  Â  Â  Â  let hero=document.getElementById('chama-hero');
Â  Â  Â  Â  const show=(sectionId==='section-intro'||sectionId==='section-final');
Â  Â  Â  Â  if(show){
Â  Â  Â  Â  Â  if(!hero){
Â  Â  Â  Â  Â  Â  hero=document.createElement('div'); hero.id='chama-hero';
Â  Â  Â  Â  Â  Â  hero.className='chama-viva chama-lg chama-strong chama-fixed-top';
Â  Â  Â  Â  Â  Â  hero.innerHTML='<div class="brasa"></div><div class="lingua"></div><div class="lingua"></div><div class="lingua"></div><div class="brilho"></div>';
Â  Â  Â  Â  Â  Â  canvas.appendChild(hero);
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } else if(hero){ hero.remove(); }
Â  Â  Â  }
Â  Â  };
Â  Â  // compat: mapear funÃ§Ãµes antigas
Â  Â  function updateChama(score){ window.JORNADA_CHAMA.updateChama(score); }
Â  Â  function ensureHeroFlame(sectionId){ window.JORNADA_CHAMA.ensureHeroFlame(sectionId); }

Â  Â  /* =========================
Â  Â  Â  Â PROGRESSO & STORAGE
Â  Â  ==========================*/
Â  Â  function updateProgress(){
Â  Â  Â  const perguntas=document.querySelectorAll('.j-pergunta');
Â  Â  Â  const respondidas=Array.from(perguntas).filter(p=>p.querySelector('textarea').value.trim()!=='').length;
Â  Â  Â  const progresso=(respondidas/(perguntas.length||1))*100;
Â  Â  Â  const fill=document.getElementById('jprog-fill');
Â  Â  Â  const badge=document.getElementById('jprog-pct');
Â  Â  Â  const jFill=document.querySelector('.j-progress__fill');
Â  Â  Â  const jMeta=document.getElementById('j-meta');
Â  Â  Â  if(fill) fill.style.width=`${progresso}%`;
Â  Â  Â  if(badge) badge.textContent=`${Math.round(progresso)}% concluÃ­do`;
Â  Â  Â  if(jFill) jFill.style.width=`${progresso}%`;
Â  Â  Â  if(jMeta) jMeta.textContent=`Respondidas: ${respondidas} de ${perguntas.length}`;
Â  Â  }
Â  Â  function saveAnswers(){
Â  Â  Â  const respostas={}; document.querySelectorAll('.j-pergunta textarea').forEach((input,idx)=>{ respostas[`q${idx}`]=input.value||''; });
Â  Â  Â  localStorage.setItem('jornada_respostas',JSON.stringify(respostas));
Â  Â  }
Â  Â  function loadAnswers(){
Â  Â  Â  const respostas=JSON.parse(localStorage.getItem('jornada_respostas')||'{}');
Â  Â  Â  document.querySelectorAll('.j-pergunta textarea').forEach((input,idx)=>{ input.value=respostas[`q${idx}`]||''; });
Â  Â  Â  updateProgress();
Â  Â  }

Â  Â  /* =========================
Â  Â  Â  Â ROTEAMENTO & RENDER
Â  Â  ==========================*/
Â  Â  function updateCanvasBackground(sectionId){
Â  Â  Â  const canvas=document.getElementById('jornada-canvas');
Â  Â  Â  if(canvas){
Â  Â  Â  Â  if(sectionId==='section-perguntas'){
Â  Â  Â  Â  Â  checkImage('/assets/img/pergaminho-rasgado-horiz.png','/assets/img/pergaminho-rasgado-vert.png').then(bg=>{
Â  Â  Â  Â  Â  Â  canvas.className=`card pergaminho pergaminho-h${bg.includes('vert')?' fallback':''}`;
Â  Â  Â  Â  Â  Â  canvas.style.backgroundImage=`url('${bg}')`;
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  canvas.className='card pergaminho pergaminho-v';
Â  Â  Â  Â  Â  canvas.style.backgroundImage='url(/assets/img/pergaminho-rasgado-vert.png)';
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }
Â  Â  function showSection(sectionId){
Â  Â  Â  document.querySelectorAll('.j-section').forEach(s=>s.classList.add('hidden'));
Â  Â  Â  const active=document.getElementById(sectionId); if(active) active.classList.remove('hidden');
Â  Â  Â  updateCanvasBackground(sectionId); ensureHeroFlame(sectionId);
Â  Â  Â  if(sectionId==='section-perguntas'){
Â  Â  Â  Â  updateProgress();
Â  Â  Â  Â  const perguntas=document.querySelectorAll('.j-pergunta'); if(perguntas.length) runTyping(perguntas[0]);
Â  Â  Â  }
Â  Â  }

Â  Â  function loadDynamicBlocks(){
Â  Â  Â  const content=document.getElementById('perguntas-container');
Â  Â  Â  if(content && window.JORNADA_BLOCKS){
Â  Â  Â  Â  content.innerHTML='';
Â  Â  Â  Â  window.JORNADA_BLOCKS.forEach((block,idx)=>{
Â  Â  Â  Â  Â  const bloco=document.createElement('section'); bloco.className='j-bloco'; bloco.dataset.bloco=idx; bloco.dataset.video=block.video_after||'';
Â  Â  Â  Â  Â  block.questions.forEach((q,qIdx)=>{
Â  Â  Â  Â  Â  Â  const pergunta=document.createElement('div'); pergunta.className='j-pergunta'; pergunta.dataset.pergunta=qIdx;
Â  Â  Â  Â  Â  Â  const label = (typeof q === 'string') ? q : (q.label || q.text || '');
Â  Â  Â  Â  Â  Â  pergunta.innerHTML=`<label class="pergunta-enunciado" data-typing data-text="<b>Pergunta ${qIdx+1}:</b> ${label}" data-speed="40" data-cursor="true"></label>
Â  Â  Â  Â  Â  Â  Â  <textarea rows="4" class="input" placeholder="Digite sua resposta..." oninput="handleInput(this)"></textarea>`;
Â  Â  Â  Â  Â  Â  bloco.appendChild(pergunta);
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  content.appendChild(bloco);
Â  Â  Â  Â  });
Â  Â  Â  Â  const firstBloco=content.querySelector('.j-bloco'); if(firstBloco){ firstBloco.style.display='block';
Â  Â  Â  Â  Â  const firstPergunta=firstBloco.querySelector('.j-pergunta'); if(firstPergunta){ firstPergunta.classList.add('active'); runTyping(firstPergunta); }
Â  Â  Â  Â  Â  loadAnswers();
Â  Â  Â  Â  Â  const firstTa=content.querySelector('.j-bloco .j-pergunta textarea'); if(firstTa) handleInput(firstTa);
Â  Â  Â  Â  }
Â  Â  Â  Â  console.log('Blocos carregados!');
Â  Â  Â  } else {
Â  Â  Â  Â  console.error('Erro: #perguntas-container ou JORNADA_BLOCKS nÃ£o encontrado!');
Â  Â  Â  }
Â  Â  }

Â  Â  function checkImage(url,fallbackUrl){
Â  Â  Â  return new Promise(resolve=>{
Â  Â  Â  Â  const img=new Image(); img.onload=()=>resolve(url); img.onerror=()=>resolve(fallbackUrl); img.src=url;
Â  Â  Â  });
Â  Â  }

Â  Â  /* =========================
Â  Â  Â  Â CONTROLES
Â  Â  ==========================*/
Â  Â  function handleInput(textarea){ const score=analyzeSentiment(textarea.value); updateChama(score); saveAnswers(); updateProgress(); }
Â  Â  function toggleSenha(){ const input=document.getElementById('senha'); if(input){ input.type=(input.type==='password'?'text':'password'); } }

Â  Â  function goNext(){
Â  Â  Â  const perguntas=document.querySelectorAll('.j-pergunta');
Â  Â  Â  const current=document.querySelector('.j-pergunta.active');
Â  Â  Â  if(current) current.classList.remove('active');
Â  Â  Â  const nextIndex=Array.from(perguntas).indexOf(current)+1;
Â  Â  Â  if(nextIndex<perguntas.length){
Â  Â  Â  Â  perguntas[nextIndex].classList.add('active'); runTyping(perguntas[nextIndex]); updateProgress();
Â  Â  Â  } else {
Â  Â  Â  Â  const blocos=document.querySelectorAll('.j-bloco');
Â  Â  Â  Â  const currentBloco=current?.closest('.j-bloco'); const nextBlocoIndex=Array.from(blocos).indexOf(currentBloco)+1;
Â  Â  Â  Â  if(nextBlocoIndex<blocos.length){
Â  Â  Â  Â  Â  const currentIdx = Number(currentBloco.dataset.bloco||0);
Â  Â  Â  Â  Â  const videoSrc = (window.JORNADA_BLOCKS[currentIdx]?.video_after)||'';
Â  Â  Â  Â  Â  blocos.forEach(b=>b.style.display='none'); blocos[nextBlocoIndex].style.display='block';
Â  Â  Â  Â  Â  const nextPergunta=blocos[nextBlocoIndex].querySelector('.j-pergunta');
Â  Â  Â  Â  Â  const proceed = ()=>{ if(nextPergunta){ nextPergunta.classList.add('active'); runTyping(nextPergunta); } };
Â  Â  Â  Â  Â  if(videoSrc) playTransition(videoSrc, proceed); else proceed();
Â  Â  Â  Â  } else { if(window.JORNADA_FINAL_VIDEO) playTransition(window.JORNADA_FINAL_VIDEO, ()=>showSection('section-final')); else { showSection('section-final'); } updateProgress(); }
Â  Â  Â  }
Â  Â  }
Â  Â  function goPrev(){
Â  Â  Â  const perguntas=document.querySelectorAll('.j-pergunta');
Â  Â  Â  const current=document.querySelector('.j-pergunta.active');
Â  Â  Â  if(current) current.classList.remove('active');
Â  Â  Â  const prevIndex=Array.from(perguntas).indexOf(current)-1;
Â  Â  Â  if(prevIndex>=0){
Â  Â  Â  Â  perguntas[prevIndex].classList.add('active'); runTyping(perguntas[prevIndex]); updateProgress();
Â  Â  Â  } else {
Â  Â  Â  Â  const blocos=document.querySelectorAll('.j-bloco');
Â  Â  Â  Â  const currentBloco=current?.closest('.j-bloco'); const prevBlocoIndex=Array.from(blocos).indexOf(currentBloco)-1;
Â  Â  Â  Â  if(prevBlocoIndex>=0){
Â  Â  Â  Â  Â  blocos.forEach(b=>b.style.display='none'); blocos[prevBlocoIndex].style.display='block';
Â  Â  Â  Â  Â  const lastPergunta=Array.from(blocos[prevBlocoIndex].querySelectorAll('.j-pergunta')).pop();
Â  Â  Â  Â  Â  if(lastPergunta){ lastPergunta.classList.add('active'); runTyping(lastPergunta); }
Â  Â  Â  Â  } else { showSection('section-intro'); }
Â  Â  Â  Â  updateProgress();
Â  Â  Â  }
Â  Â  }

Â  Â  function playTransition(src,onEnd){
Â  Â  Â  const overlay=document.getElementById('videoOverlay');
Â  Â  Â  const video=document.getElementById('videoTransicao');
Â  Â  Â  const skip=document.getElementById('skipVideo');
Â  Â  Â  if(overlay && video && src){
Â  Â  Â  Â  video.src=src; overlay.classList.remove('hidden');
Â  Â  Â  Â  const cleanup=()=>{ try{video.pause();}catch(e){} overlay.classList.add('hidden'); video.removeAttribute('src'); video.load(); onEnd&&onEnd(); };
Â  Â  Â  Â  video.onended=cleanup;
Â  Â  Â  Â  video.onerror=()=>{ console.warn('VÃ­deo nÃ£o carregou:',src); cleanup(); };
Â  Â  Â  Â  if(skip) skip.onclick=cleanup;
Â  Â  Â  Â  video.muted=false;
Â  Â  Â  Â  video.play().catch(err=>{ console.warn('Erro ao reproduzir vÃ­deo:',err); cleanup(); });
Â  Â  Â  Â  setTimeout(cleanup,12000);
Â  Â  Â  } else { onEnd&&onEnd(); }
Â  Â  }

Â  Â  function finalize(){
Â  Â  Â  const respostas={}; document.querySelectorAll('.j-pergunta textarea').forEach((input,idx)=>{ respostas[`q${idx}`]=input.value||''; });
Â  Â  Â  console.log('[JORNADA] Finalizado. Respostas:', respostas);
Â  Â  Â  alert('Jornada concluÃ­da!'); localStorage.removeItem('jornada_respostas');
Â  Â  Â  setTimeout(()=>location.replace('/index.html'),1000);
Â  Â  }

Â  Â  function startJourney(){
Â  Â  Â  const senha=document.getElementById('senha')?.value || '';
Â  Â  Â  const senhasValidas=['iniciar','olho magico','olho mÃ¡gico'];
Â  Â  Â  if(senhasValidas.includes(senha.toLowerCase())){
Â  Â  Â  Â  (window.showSection||showSection)('section-perguntas');
Â  Â  Â  Â  loadDynamicBlocks();
Â  Â  Â  Â  const perguntas=document.querySelectorAll('.j-pergunta');
Â  Â  Â  Â  if(perguntas.length){
Â  Â  Â  Â  Â  perguntas[0].classList.add('active'); runTyping(perguntas[0]);
Â  Â  Â  Â  Â  const firstTa=document.querySelector('.j-pergunta.active textarea'); if(firstTa) handleInput(firstTa);
Â  Â  Â  Â  } else { console.error('Nenhuma pergunta encontrada apÃ³s loadDynamicBlocks!'); }
Â  Â  Â  Â  document.querySelector('.progress-badge')?.classList.remove('hidden');
Â  Â  Â  Â  document.querySelector('.progress-bar')?.classList.remove('hidden');
Â  Â  Â  Â  document.querySelector('.j-progress')?.classList.remove('hidden');
Â  Â  Â  Â  document.querySelector('.footer-actions')?.classList.remove('hidden');
Â  Â  Â  Â  updateProgress(); console.log('Jornada iniciada com sucesso!');
Â  Â  Â  } else { alert('Senha incorreta. Tente novamente.'); }
Â  Â  }

Â  Â  function initJornada(){
Â  Â  Â  const prevBtn=document.getElementById('btnPrevPerguntas');
Â  Â  Â  const nextBtn=document.getElementById('btnNextPerguntas');
Â  Â  Â  const restartBtn=document.getElementById('btnRestart');
Â  Â  Â  if(nextBtn) nextBtn.addEventListener('click', goNext);
Â  Â  Â  if(prevBtn) prevBtn.addEventListener('click', goPrev);
Â  Â  Â  if(restartBtn) restartBtn.addEventListener('click', ()=>location.reload());

Â  Â  Â  // DelegaÃ§Ã£o de cliques (sem onclick no HTML)
Â  Â  Â  document.addEventListener('click',(ev)=>{
Â  Â  Â  Â  const n = ev.target.closest('[data-action="next"]');
Â  Â  Â  Â  const p = ev.target.closest('[data-action="prev"]');
Â  Â  Â  Â  const s = ev.target.closest('[data-action="start"]');
Â  Â  Â  Â  const tp= ev.target.closest('[data-action="toggle-password"], .password-toggle');
Â  Â  Â  Â  if(n){ev.preventDefault();goNext();}
Â  Â  Â  Â  if(p){ev.preventDefault();goPrev();}
Â  Â  Â  Â  if(s){ev.preventDefault();startJourney();}
Â  Â  Â  Â  if(tp){ev.preventDefault();toggleSenha();}
Â  Â  Â  });

Â  Â  Â  console.log('Controlador da jornada inicializado!');
Â  Â  }

Â  Â  // Fallback/blocos + vÃ­deos padronizados
Â  Â  (function defineFallback(){
Â  Â  Â  window.JORNADA_BLOCKS=[
Â  Â  Â  Â  { title:'Bloco 1 â€” RaÃ­zes', questions:[ 'Quem Ã© vocÃª hoje?', 'O que a Luz te pede agora?' ], video_after:'/assets/img/filme-1-entrando-na-jornada.mp4' },
Â  Â  Â  Â  { title:'Bloco 2 â€” Caminho', questions:[ 'Qual verdade vocÃª precisa admitir para seguir?', 'O que precisa ser curado neste momento?' ], video_after:'/assets/img/filme-2-dentro-da-jornada.mp4' }
Â  Â  Â  ];
Â  Â  Â  window.JORNADA_FINAL_VIDEO='/assets/img/filme-5-fim-da-jornada.mp4';
Â  Â  Â  console.log('JORNADA_BLOCKS (fallback) prontos.');
Â  Â  })();

Â  Â  async function boot(){
Â  Â  Â  document.body.classList.add('jornada-active');
Â  Â  Â  const route=(location.hash||'#intro').slice(1);
Â  Â  Â  const canvas=document.getElementById('jornada-canvas');
Â  Â  Â  const progressBadge=document.querySelector('.progress-badge');
Â  Â  Â  const progressBar=document.querySelector('.progress-bar');
Â  Â  Â  const jProgress=document.querySelector('.j-progress');
Â  Â  Â  const footerActions=document.querySelector('.footer-actions');

Â  Â  Â  if(canvas){
Â  Â  Â  Â  if(route==='perguntas'){
Â  Â  Â  Â  Â  showSection('section-perguntas'); loadDynamicBlocks();
Â  Â  Â  Â  Â  [progressBadge,progressBar,jProgress,footerActions].forEach(el=>el?.classList.remove('hidden'));
Â  Â  Â  Â  } else if(route==='final'){
Â  Â  Â  Â  Â  showSection('section-final'); [progressBadge,progressBar,jProgress].forEach(el=>el?.classList.remove('hidden'));
Â  Â  Â  Â  } else { showSection('section-intro'); }
Â  Â  Â  }
Â  Â  Â  runTyping(document); return true;
Â  Â  }

Â  Â  // InicializaÃ§Ã£o
Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  runTyping(document);
Â  Â  Â  initJornada();

Â  Â  Â  boot().then(() => {
Â  Â  Â  Â  const visible = document.querySelector('.j-section:not(.hidden)');
Â  Â  Â  Â  if (visible) ensureHeroFlame(visible.id);
Â  Â  Â  });

Â  Â  Â  const target = document.getElementById('jornada-conteudo');
Â  Â  Â  if (target) {
Â  Â  Â  Â  const obs = new MutationObserver(muts => {
Â  Â  Â  Â  Â  muts.forEach(m => {
Â  Â  Â  Â  Â  Â  runTyping(m.target);
Â  Â  Â  Â  Â  Â  if (m.target.id === 'perguntas-container') updateProgress();
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  });
Â  Â  Â  Â  window.ensureHeroFlame = ensureHeroFlame;
Â  Â  Â  Â  obs.observe(target, { childList: true, subtree: true });
Â  Â  Â  }
Â  Â  });

Â  Â  // Ponte global
Â  Â  window.JC = window.JC || {};
Â  Â  window.toggleSenhaÂ  = toggleSenha;
Â  Â  window.startJourney = startJourney;
Â  Â  window.showSectionÂ  = showSection;
Â  Â  window.JC.toggleSenhaÂ  = toggleSenha;
Â  Â  window.JC.startJourney = startJourney;
Â  Â  window.JC.showSectionÂ  = showSection;
Â  Â  window.JC.Chama = window.JORNADA_CHAMA;
Â  </script>

Â  Â  <script defer src="/config.js" onerror="console.error('Falha ao carregar config.js, usando fallback inline');"></script>
Â  <script defer src="/jornada-utils.js" onerror="console.error('Falha ao carregar jornada-utils.js, usando fallback inline');"></script>
Â  <script defer src="/jornada-core.js" onerror="console.error('Falha ao carregar jornada-core.js, usando fallback inline');"></script>
Â  <script defer src="/jornada-auth.js" onerror="console.error('Falha ao carregar jornada-auth.js, usando fallback inline');"></script>
Â  <script defer src="/jornada-chama.js" onerror="console.error('Falha ao carregar jornada-chama.js, usando fallback inline');"></script>
Â  <script defer src="/jornada-paper-qa.js" onerror="console.error('Falha ao carregar jornada-paper-qa.js, usando fallback inline');"></script>
Â  <script defer src="/jornada-typing.js" onerror="console.error('Falha ao carregar jornada-typing.js, usando fallback inline');"></script>
Â  <script defer src="/jornada-controller.js" onerror="console.error('Falha ao carregar jornada-controller.js, usando fallback inline');"></script>
Â  <script defer src="/jornada-render.js" onerror="console.error('Falha ao carregar jornada-render.js, usando fallback inline');"></script>
Â  <script defer src="/jornada-bootstrap.js" onerror="console.error('Falha ao carregar jornada-bootstrap.js, usando fallback inline');"></script>
Â  <script defer src="/jornada-micro.js" onerror="console.error('Falha ao carregar jornada-micro.js, usando fallback inline');"></script>
Â  <script defer src="/i18n/i18n.js" onerror="console.error('Falha ao carregar i18n.js, usando fallback inline');"></script>
Â  <script defer src="/api.js" onerror="console.error('Falha ao carregar api.js, usando fallback inline');"></script>
</body>
</html>
