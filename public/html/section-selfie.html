<link rel="stylesheet" href="/assets/css/styles-base.css">
<link rel="stylesheet" href="/assets/css/styles-selfie.css">

<section
  id="section-selfie"
  class="j-section pergaminho pergaminho-h epic selfie-page"
  data-section="selfie"
  aria-labelledby="selfie-title"
  data-transition-src="/assets/videos/filme-selfie-card.mp4"
>
  <div class="conteudo-pergaminho">
    <!-- Cabeçalho -->
    <header class="selfie-header">
      <h2
        id="selfie-title"
        class="titulo-pergaminho"
        data-typing="true"
        data-text="Tirar sua Foto ✨"
        data-speed="30"
        data-cursor="true"
      ></h2>

      <button
        id="btnSkipSelfie"
        class="btn btn-ghost-top"
        aria-label="Não quero foto / Iniciar"
        data-transition-src="/assets/videos/filme-selfie-card.mp4"
      >
        Não quero foto / Iniciar
      </button>
    </header>

    <!-- Texto orientativo -->
    <div class="moldura-orientacao">
      <div
        id="selfieTexto"
        class="texto-orientacao"
        data-text="{{NOME}}, posicione-se em frente à câmera e centralize o rosto dentro da chama. Use boa luz e evite sombras."
        data-speed="36"
      ></div>
    </div>

    <!-- Grade principal -->
    <div class="selfie-grid">
      <!-- Prévia ao vivo + máscara -->
      <div class="selfie-preview">
        <div class="flame-stage">
          <video id="selfieVideo" playsinline autoplay muted></video>
          <canvas id="selfieCanvas" class="hidden"></canvas>
          <div class="flame-mask"></div>
        </div>

        <div class="preview-hints">
          <small>Certifique-se de que o rosto está centralizado no quadro.</small>
        </div>
      </div>

      <!-- Controles -->
      <aside class="selfie-controls">
        <!-- (Opcional) Nome: se já vem da página guia, pode esconder este input via CSS -->
        <div class="field-row">
          <label for="nameInput">Seu Nome</label>
          <input
            id="nameInput"
            type="text"
            placeholder="NOME"
            autocomplete="name"
            class="input-espinhos"
          />
        </div>

        <button id="startCamBtn" class="btn btn-stone-espinhos">Ativar Câmera</button>

        <div class="ranges">
          <label>Zoom
            <input id="zoomAll" type="range" min="1" max="2.5" step="0.01" value="1" />
          </label>
          <label>Zoom Horizontal
            <input id="zoomX" type="range" min="1" max="2.5" step="0.01" value="1" />
          </label>
          <label>Zoom Vertical
            <input id="zoomY" type="range" min="1" max="2.5" step="0.01" value="1" />
          </label>
        </div>

        <div class="btn-row">
          <button id="btn-selfie-preview" class="btn btn-stone-espinhos" disabled>Prévia</button>
          <button id="btn-selfie-confirm" class="btn btn-stone-espinhos" disabled>Confirmar</button>
          <button
            id="btn-selfie-next"
            class="btn btn-stone-espinhos"
            disabled
            data-transition-src="/assets/videos/filme-selfie-card.mp4"
          >
            Iniciar Jornada
          </button>
        </div>
      </aside>
    </div>

    <!-- Pré-visualização estática da captura -->
    <div class="selfie-preview-wrap">
      <div class="preview-frame">
        <img id="selfiePreview" alt="Pré-visualização da foto" />
      </div>
    </div>

    <div id="selfie-error" class="hidden" aria-hidden="true">
      Não foi possível acessar a câmera. Verifique as permissões do navegador.
    </div>
  </div>
</section>
