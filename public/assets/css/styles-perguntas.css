/* ===========================================================
   STYLES-PERGUNTAS — REFRATORADO v2.0 (LIMPO)
   Caminho: /assets/css/styles-perguntas.css
   Objetivo: Desktop + Mobile polivalente, sem duplicações
   =========================================================== */

/* ---------- Variáveis ---------- */
:root{
  --gold-gradient: linear-gradient(90deg, #d4af37, #ffd700, #ffcc33);
  --silver-gradient: linear-gradient(90deg, #d3d3d3, #b0b0b0, #f0f0f0);

  /* fallback caso guia não injete cor */
  --progress-main: var(--theme-main-color, #f5d47b);
  --progress-glow-1: rgba(255,230,180,.85);
  --progress-glow-2: rgba(255,210,120,.75);
}

/* ===========================================================
   WRAPPER GERAL DA SEÇÃO
   =========================================================== */
.section-perguntas{
  position: relative;
  min-height: 100dvh;
  padding: 32px 12px 18px;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  font-family: "Cardo", serif;
  color: #f5e9d6;
  background: transparent;
}

.section-perguntas .perguntas-wrap{
  position: relative;
  width: min(1024px, 100%);
  margin: 0 auto;
  padding: 74px 14px 78px;  /* topo HUD + ampulheta | base HUD inferior */
  padding-top: 18px;          /* abre espaço entre o vidro e a régua */
  padding-bottom: 16px;
  border-radius: 18px;
  background: rgba(0,0,0,0.45);
  box-shadow: 0 18px 60px rgba(0,0,0,0.85);
  backdrop-filter: blur(6px);
  box-sizing: border-box;
}

/* não encolher nada dentro da j-panel */
.perguntas-panel .j-arcane-card,
.perguntas-panel .perguntas-wrap,
.perguntas-panel #jp-blocks-wrapper{
  width: 100%;
  max-width: 100%;
}

/* ===========================================================
   HUD DE PROGRESSO (TOPO + INFERIOR) + AMPULHETA
   =========================================================== */

.progress-top{
  position: absolute;
  top: 14px;
  margin-bottom: 10px;        /* descola a pergunta da régua de cima */
  left: 14px;
  right: 88px;     /* mais folga pra ampulheta */
  padding-top: 14px; /* espaço pro número ficar em cima */
  z-index: 12;
}

/* trilha mais larga e com glow forte */
.progress-top .progress-bar{
  height: 8px;
  border-radius: 999px;
  background: rgba(0,0,0,0.60);
  box-shadow:
    inset 0 0 10px rgba(0,0,0,0.95),
    0 0 10px color-mix(in srgb, var(--theme-main-color, #d4af37) 70%, transparent),
    0 0 24px color-mix(in srgb, var(--theme-main-color, #d4af37) 45%, transparent);
}

.progress-top .progress-fill{
  box-shadow:
    0 0 10px color-mix(in srgb, var(--theme-main-color, #ffd700) 80%, transparent),
    0 0 22px color-mix(in srgb, var(--theme-main-color, #ffd700) 60%, transparent),
    inset 0 0 6px rgba(255,255,255,0.35);
}

.progress-top .progress-value{
  position: absolute;
  top: -2px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 14px;
  font-weight: 800;
  color: #ffe9a6;
  text-shadow: 0 1px 2px #000;
  white-space: nowrap;
  pointer-events: none;
}

/* ---------- BARRA INFERIOR (PERGUNTAS NO BLOCO) ---------- */
.progress-middle{
  position: absolute;
  margin-top: 12px; 
  left: 50%;
  bottom: -6px;          
  transform: translateX(-50%);
  width: min(90%, 560px);

  display: flex;
  align-items: center;
  gap: 8px;

  font-size: 12.5px;
  font-family: "Cinzel", serif;
  z-index: 12;

  margin: 0;
  padding: 0;
  background: transparent;
  box-shadow: none;
}

.progress-middle .progress-bar{
  height: 8px !important;
  border-radius: 999px;
  background: rgba(0,0,0,0.65);
  box-shadow:
    inset 0 0 10px rgba(0,0,0,1),
    0 0 8px color-mix(in srgb, var(--theme-main-color, #d4af37) 60%, transparent),
    0 0 20px color-mix(in srgb, var(--theme-main-color, #d4af37) 40%, transparent);
}

.progress-middle .progress-fill{
  box-shadow:
    0 0 10px color-mix(in srgb, var(--theme-main-color, #ffd700) 80%, transparent),
    0 0 22px color-mix(in srgb, var(--theme-main-color, #ffd700) 60%, transparent),
    inset 0 0 6px rgba(255,255,255,0.35);
}

.progress-middle .progress-value{
  position: relative;
  margin-left: 6px;
  white-space: nowrap;
  font-size: 14px;
  font-weight: 600;
  letter-spacing: .04em;  
}

/* ---------- Ampulheta total ---------- */
.progress-total{
  position: absolute;
  top: 14px;
  right: 16px;
  display: flex;
  align-items: center;
  gap: 6px;
  z-index: 11;
  font-size: 1.05rem;
  color: #ffd700;
  text-shadow: 0 1px 3px #000;
  font-weight: 800;
}

.progress-total .ampulheta{
  font-size: 1.9rem;
  display: inline-block;
  animation: spinHourglass 8s infinite linear;
  filter: drop-shadow(0 0 10px #ffda6b);
}

@keyframes spinHourglass{
  0%,100%{ transform: rotate(0deg); }
  50%{ transform: rotate(180deg); }
}

/* ===========================================================
   CABEÇALHO / PERGAMINHO / PERGUNTA
   =========================================================== */

.perguntas-header{
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
  font-size: 12px;
}

.jp-block-label{
  font-size: 15px;            /* nome do bloco */
  font-weight: 600;
  letter-spacing: .03em;
  text-transform: uppercase;
  color: #ffd38a;
}

.jp-global-counter{
  font-size: 11px;
  color: #f5e9d6;
}

/* Pergaminho interno */
.perguntas-pergaminho{
  margin-top: 6px;
  padding: 12px 10px 10px;
  border-radius: 16px;
  background-image: url('/assets/img/pergaminho-rasgado-horiz.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
}

/* Pergunta datilografada */
.jp-question-typed{
  min-height: 42px;
  margin-bottom: 14px;
  font-size: 20px;
  line-height: 1.5;
  color: #ffffff;
  font-weight: 600;
  text-shadow: 0 1px 2px #000;
}

/* ===========================================================
   ANSWER FRAME (moldura medieval)
   =========================================================== */

.jp-answer-frame{
  position: relative;
  margin-top: 4px;
  padding: 12px 14px;
  border-radius: 12px;
  background-image: url('/assets/img/moldura-medieval.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  box-shadow: 0 10px 26px rgba(0,0,0,0.9);
}

.jp-answer-bg{
  position: absolute;
  inset: 8px;
  border-radius: 10px;
  background: radial-gradient(circle at top, rgba(255,255,255,0.06), transparent);
  pointer-events: none;
}

.jp-answer-input{
  position: relative;
  width: 100%;
  min-height: 80px;
  border: none;
  outline: none;
  padding: 8px;
  border-radius: 8px;
  background: transparent;
  color: #f7e9c8;
  font-size: 16px !important;
  line-height: 1.45;
  resize: vertical;
  z-index: 5;
}

/* Microfone */
.jp-answer-frame .jp-mic{
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important; 
 /*position: absolute;
   right: 10px;
   bottom: 10px;
   width: 26px;
   height: 26px;
   z-index: 20;
   pointer-events: auto !important;
//  cursor: pointer; */
}

/* ===========================================================
   DEVOLUTIVA DA API (reserva de espaço no miolo)
   =========================================================== */
#jp-ai-response,
.jp-ai-response{
  display: block;
  width: 100%;
  margin: 10px auto 12px;
  padding: 10px 12px;

  min-height: 88px;
  border-radius: 12px;

  background: rgba(0,0,0,0.55);
  border: 1px solid rgba(255,215,120,0.35);
  box-shadow: inset 0 0 10px rgba(0,0,0,0.8);

  font-family: "Cardo", serif;
  font-size: 14px;
  line-height: 1.5;
  color: #f7e7c4;
  text-shadow: 0 1px 2px #000;

  overflow: hidden;
}

#jp-ai-response[hidden]{
  visibility: hidden;
  opacity: 0;
}

/* ===========================================================
   CONTROLES / BOTÕES
   =========================================================== */

.perguntas-controls{
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
  width: 100%;
  max-width: 520px;
  margin: 0 auto;
}

.btn-perguntas{
  height: 42px;
  width: 100%;
  padding: 0 8px;
  border-radius: 999px;
  border: 1px solid rgba(255,220,170,0.6);
  background-image: url('/assets/img/textura-de-pedra.jpg');
  background-size: cover;
  background-position: center;
  color: #ffd38a;
  font-size: 12px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  box-shadow: 0 6px 14px rgba(0,0,0,0.85);
  text-shadow: 0 1px 2px rgba(0,0,0,0.9);
  white-space: nowrap;
  transition: transform .12s ease, box-shadow .12s ease;
}

.btn-perguntas.btn-confirm{
  font-weight: 700;
  border-color: rgba(255,230,180,0.9);
}

.btn-perguntas:hover{
  transform: translateY(-1px);
  box-shadow: 0 8px 18px rgba(0,0,0,0.95);
}


/* ===========================================================
   PULSO DO GUIA — MAIS INTENSO E VIVO
   (versão única — sem duplicar keyframes)
   =========================================================== */
@keyframes guiaGlow{
  0%{
    filter: brightness(1) saturate(1.05);
    box-shadow:
      0 0 8px  color-mix(in srgb, var(--theme-main-color, #ffd700) 70%, transparent),
      0 0 18px color-mix(in srgb, var(--theme-main-color, #ffd700) 50%, transparent),
      inset 0 0 4px rgba(255,255,255,0.25);
  }
  35%{
    filter: brightness(1.45) saturate(1.45);
    box-shadow:
      0 0 14px color-mix(in srgb, var(--theme-main-color, #ffd700) 90%, transparent),
      0 0 34px color-mix(in srgb, var(--theme-main-color, #ffd700) 70%, transparent),
      0 0 70px color-mix(in srgb, var(--theme-main-color, #ffd700) 45%, transparent),
      inset 0 0 8px rgba(255,255,255,0.40);
  }
  70%{
    filter: brightness(1.2) saturate(1.25);
    box-shadow:
      0 0 11px color-mix(in srgb, var(--theme-main-color, #ffd700) 80%, transparent),
      0 0 26px color-mix(in srgb, var(--theme-main-color, #ffd700) 60%, transparent),
      inset 0 0 6px rgba(255,255,255,0.32);
  }
  100%{
    filter: brightness(1) saturate(1.05);
    box-shadow:
      0 0 8px  color-mix(in srgb, var(--theme-main-color, #ffd700) 70%, transparent),
      0 0 18px color-mix(in srgb, var(--theme-main-color, #ffd700) 50%, transparent),
      inset 0 0 4px rgba(255,255,255,0.25);
  }
}

.progress-top .progress-fill,
.progress-middle .progress-fill{
  animation: guiaGlow 1.9s ease-in-out infinite !important;
}

/* =========================================================
   ESTILO BASE - FUNCIONA EM TODAS AS TELAS (DESKTOP E MOBILE)
   ========================================================= */

/* Barra "Perguntas no Bloco" - posicionamento fixo e bonito sempre */
.progress-inline,
#progress-inline {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  gap: 12px !important;
  margin: 20px auto !important;
  padding: 10px 20px !important;
  background: rgba(0,0,0,0.5) !important;
  border-radius: 30px !important;
  box-shadow: 0 4px 20px rgba(0,0,0,0.7) !important;
  width: fit-content !important;
  font-size: 1rem !important;
}

/* Aura do guia na barra - SEMPRE ativa */
.progress-question-fill,
#progress-question-fill {
  background: var(--progress-main, #ff00ff) !important;
  box-shadow: 0 0 30px var(--progress-main), 0 0 60px var(--progress-glow-1) !important;
  height: 100% !important;
  border-radius: inherit !important;
}

/* Aura específica por guia - FORTE e SEMPRE VISÍVEL */
body[data-guia="lumen"] .progress-question-fill {
  box-shadow: 0 0 30px #00ff9d, 0 0 60px rgba(0,255,157,0.9), inset 0 0 30px rgba(120,255,200,0.7) !important;
}

body[data-guia="zion"] .progress-question-fill {
  box-shadow: 0 0 30px #00aaff, 0 0 60px rgba(0,170,255,0.9), 0 0 45px rgba(255,214,91,0.7) !important;
}

body[data-guia="arian"] .progress-question-fill {
  box-shadow: 0 0 35px #ff00ff, 0 0 70px rgba(255,120,255,0.95), inset 0 0 35px rgba(255,180,255,0.8) !important;
}

/* Botões com aura do guia - SEMPRE */
.perguntas-controls .btn-perguntas {
  border-color: var(--progress-main) !important;
  box-shadow: 
    0 6px 18px rgba(0,0,0,0.6),
    0 0 20px var(--progress-glow-1),
    0 0 35px var(--progress-glow-2) !important;
}

/* Aura específica nos botões */
body[data-guia="lumen"] .perguntas-controls .btn-perguntas {
  box-shadow: 0 6px 18px rgba(0,0,0,0.6), 0 0 25px #00ff9d, 0 0 50px rgba(0,255,157,0.8) !important;
}
body[data-guia="zion"] .perguntas-controls .btn-perguntas {
  box-shadow: 0 6px 18px rgba(0,0,0,0.6), 0 0 25px #00aaff, 0 0 50px rgba(0,170,255,0.8), 0 0 35px rgba(255,214,91,0.6) !important;
}
body[data-guia="arian"] .perguntas-controls .btn-perguntas {
  box-shadow: 0 6px 18px rgba(0,0,0,0.6), 0 0 30px #ff00ff, 0 0 60px rgba(255,120,255,0.9) !important;
}

/* Botão Falar gravando - VERMELHO FORTE sempre */
#jp-btn-falar.recording {
  background: linear-gradient(135deg, #ff1744, #d50000) !important;
  border-color: #ff1744 !important;
  box-shadow: 0 0 40px #ff1744, 0 0 80px #ff4444, 0 0 120px rgba(255,23,68,0.9) !important;
  animation: pulse-recording 1.3s infinite !important;
  transform: scale(1.1) !important;
}

@keyframes pulse-recording {
  0%, 100% { box-shadow: 0 0 40px #ff1744, 0 0 80px #ff4444; }
  50% { box-shadow: 0 0 60px #ff1744, 0 0 110px #ff6666; }
}

/* =======================================================
   BOTÕES PERGUNTAS - TEXTURA PEDRA + COR DO GUIA
   ======================================================= */

/* FORÇA 3 BOTÕES LADO A LADO - MOBILE E DESKTOP */
.perguntas-controls {
  display: flex !important;
  justify-content: center !important;
  align-items: center !important;
  gap: 16px !important;
  margin: 28px auto 0 !important;
  padding: 10px 20px !important;
  width: 100% !important;
  max-width: 600px !important;
  box-sizing: border-box !important;
}

/* BOTÕES BASE - TEXTURA DE PEDRA OBRIGATÓRIA */
.perguntas-controls .btn-perguntas {
  flex: 1 !important;
  min-width: 100px !important;
  max-width: 140px !important;
  height: 64px !important;
  padding: 10px !important;
  font-size: 15px !important;
  font-weight: bold !important;
  border-radius: 32px !important;
  display: flex !important;
  flex-direction: column !important;
  justify-content: center !important;
  align-items: center !important;
  gap: 4px !important;
  position: relative !important;
  overflow: hidden !important;

  /* TEXTURA DE PEDRA FORÇADA - NUNCA SOME */
  background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.3)),
              url('/assets/img/textura-de-pedra.jpg') !important;
  background-size: cover !important;
  background-position: center !important;

  border: 3px solid transparent !important;
  box-shadow: 0 6px 18px rgba(0,0,0,0.6) !important;
  transition: all 0.4s ease !important;
  text-shadow: 1px 1px 2px black !important;
  color: white !important;
}

/* AVANÇA MAIOR */
.perguntas-controls .btn-confirm {
  flex: 1.6 !important;
  max-width: 170px !important;
  height: 70px !important;
  font-size: 17px !important;
}

/* AURA DO GUIA NOS BOTÕES (borda + glow) */
body[data-guia="lumen"] .perguntas-controls .btn-perguntas {
  border-color: #00ff9d !important;
  box-shadow: 0 6px 18px rgba(0,0,0,0.6), 0 0 20px rgba(0,255,157,0.7) !important;
}

body[data-guia="zion"] .perguntas-controls .btn-perguntas {
  border-color: #00aaff !important;
  box-shadow: 0 6px 18px rgba(0,0,0,0.6), 0 0 20px rgba(0,170,255,0.7), 0 0 30px rgba(255,214,91,0.5) !important;
}

body[data-guia="arian"] .perguntas-controls .btn-perguntas {
  border-color: #ff00ff !important;
  box-shadow: 0 6px 18px rgba(0,0,0,0.6), 0 0 25px rgba(255,0,255,0.8) !important;
}

/* EFEITO AO CLICAR EM AVANÇA - EXPLOSÃO DE LUZ DO GUIA */
.perguntas-controls .btn-confirm:active {
  transform: scale(0.94) !important;
  box-shadow: 0 0 50px var(--progress-main), 0 0 80px var(--progress-glow-1) !important;
}

/* MICROFONE ATIVO - VERMELHO FORTE E PULSANDO (prioridade máxima) */
#jp-btn-falar.recording,
.perguntas-controls #jp-btn-falar.recording,
.perguntas-controls .btn-perguntas.recording,
.btn-perguntas[data-action="start-mic"].recording {
  background: linear-gradient(135deg, #ff1744, #d50000) !important;
  background-color: #f44336 !important; /* fallback sólido */
  border-color: #ff1744 !important;
  color: white !important;
  box-shadow: 
    0 0 30px #ff1744,
    0 0 60px #ff4444,
    0 0 90px rgba(255, 23, 68, 0.8) !important;
  animation: pulse-recording 1.4s infinite !important;
  transform: scale(1.12) !important;
  z-index: 9999 !important;
}

@keyframes pulse-recording {
  0% {
    box-shadow: 0 0 30px #ff1744, 0 0 60px #ff4444, 0 0 90px rgba(255, 23, 68, 0.8);
  }
  50% {
    box-shadow: 0 0 45px #ff1744, 0 0 80px #ff6666, 0 0 120px rgba(255, 23, 68, 1);
  }
  100% {
    box-shadow: 0 0 30px #ff1744, 0 0 60px #ff4444, 0 0 90px rgba(255, 23, 68, 0.8);
  }
}

/* Opcional: texto "Gravando" enquanto ativo */
#jp-btn-falar.recording::after {
  content: " ● Gravando";
  font-size: 0.8em;
  margin-left: 6px;
  animation: blink 1s infinite;
}

@keyframes blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.3; }
}
/* BARRAS DE PROGRESSO - TEXTURA PEDRA + AURA DO GUIA (igual aos botões) */

/* Barra externa (fundo vazio) - pedra sutil */
#progress-block-outer,
#progress-question-outer,
.progress-block-outer,
.progress-question-outer,
.perg-progress-outer,
.progress-bar {
  background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.4)),
              url('/assets/img/textura-de-pedra.jpg') !important; /* ajuste o nome exato se for diferente */
  background-size: cover !important;
  background-position: center !important;
  border-radius: 20px !important;
  box-shadow: inset 0 4px 12px rgba(0,0,0,0.7) !important;
  height: 12px !important; /* um pouco mais grossa pra textura aparecer melhor */
}

/* Preenchimento da barra (o que cresce com JS) */
#progress-block-fill,
#progress-question-fill,
.progress-block-fill,
.progress-question-fill,
.perg-progress-inner,
.progress-fill {
  height: 100% !important;
  border-radius: inherit !important;
  position: relative !important;
  overflow: hidden !important;

  /* TEXTURA DE PEDRA NO PREENCHIMENTO */
  background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.3)),
              url('/assets/img/textura-de-pedra.jpg') !important;
  background-size: cover !important;
  background-position: center !important;

  /* AURA LUMINOSA PULSANDO NA COR DO GUIA */
  box-shadow: 
    0 0 20px var(--progress-main),
    0 0 40px var(--progress-glow-1),
    inset 0 0 25px var(--progress-glow-2) !important;
  animation: barra-glow 4s infinite alternate !important;
}

@keyframes barra-glow {
  0% { 
    box-shadow: 0 0 15px var(--progress-main), 0 0 30px var(--progress-glow-1); 
  }
  100% { 
    box-shadow: 0 0 30px var(--progress-main), 0 0 60px var(--progress-glow-1), inset 0 0 35px var(--progress-glow-2); 
  }
}

/* Garante aura do guia na barra movida (qualquer tela) */
.progress-inline .progress-question-fill,
#progress-question-fill {
  background: var(--progress-main, #00ff9d) !important;
  box-shadow: var(--progress-glow-1, 0 0 20px #00ff9d), var(--progress-glow-2, 0 0 40px rgba(0,255,157,0.8)) !important;
}

/* Aura específica por guia (reforçada) */
body[data-guia="lumen"] .progress-inline .progress-question-fill {
  box-shadow: 0 0 25px #00ff9d, 0 0 50px rgba(0,255,157,0.9) !important;
}
body[data-guia="zion"] .progress-inline .progress-question-fill {
  box-shadow: 0 0 25px #00aaff, 0 0 50px rgba(0,170,255,0.9), 0 0 35px rgba(255,214,91,0.7) !important;
}
body[data-guia="arian"] .progress-inline .progress-question-fill {
  box-shadow: 0 0 30px #ff00ff, 0 0 60px rgba(255,120,255,0.95) !important;
}

/* Wrapper da barra movida - sempre bonito */
.progress-inline {
  background: rgba(0,0,0,0.5) !important;
  border-radius: 20px !important;
  padding: 8px 16px !important;
  box-shadow: 0 4px 15px rgba(0,0,0,0.6) !important;
}
/* ======================================================
   PERGUNTAS — título e barra no mesmo eixo vertical
   ====================================================== */

/* container do bloco */
.perguntas-no-bloco{
  position: relative !important;
  margin-top: 12px !important;
  margin-bottom: 10px !important;
}

/* título */
.perguntas-no-bloco .titulo-bloco,
.perguntas-no-bloco h3{
  margin-bottom: 6px !important;
  text-align: center;
}

/* barra logo abaixo do título */
.perguntas-no-bloco .barra-progresso,
.perguntas-no-bloco .progress-bar{
  margin-top: 4px !important;
}
   /* ======================================================
   BOTÕES — magia consistente em todos os estados
   ====================================================== */

.j-pergunta .btn,
.j-pergunta button{
  box-shadow:
    0 0 12px color-mix(in srgb, var(--guide-color, #ffd700) 45%, transparent);
  border-color: var(--guide-color, #ffd700);
}

/* hover / ativo */
.j-pergunta .btn:hover,
.j-pergunta .btn.ativo{
  box-shadow:
    0 0 26px color-mix(in srgb, var(--guide-color, #ffd700) 75%, transparent);
}
