/* ===== SECTION SELFIE ===== */

#section-selfie {
  background: transparent !important;
  min-height: 85vh;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding-top: 36px;
  padding-bottom: 48px;
}

.section-selfie .parchment-inner-rough {
  width: 100%;
  max-width: 980px;
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.conteudo-pergaminho { width: 100%; }

/* Cabeçalho */
.selfie-header{
  display:flex;
  justify-content: space-between;
  align-items: center;
  gap: 16px;
  margin-bottom: 10px;
}
.titulo-pergaminho{
  margin: 0;
  font-size: 30px;
  color: #fff8dc;
  text-shadow: 2px 2px 6px rgba(0,0,0,.6);
}

.btn-ghost-top{
  background: transparent;
  border: 2px solid rgba(255,255,255,.35);
  color: #fff;
  border-radius: 10px;
  padding: 8px 12px;
  opacity: .9;
}
.btn-ghost-top:hover{ background: rgba(255,255,255,.08); }

/* Moldura do texto orientativo */
.moldura-orientacao{
  width: 100%;
  max-width: 900px;
  margin: 6px auto 16px;
  padding: 14px 18px;
  border-radius: 12px;
  background: rgba(0,0,0,.28);
  box-shadow: inset 0 0 12px rgba(255,215,0,.2);
}
.texto-orientacao{
  font-family: 'BerkshireSwash', cursive;
  color: #fff0d0;
  font-size: 18px;
  line-height: 1.5;
  opacity: 0;
}
.texto-orientacao.typing-active,
.texto-orientacao.typing-done{ opacity: 1 !important; }

/* Área de captura */
.selfie-capture-wrap{
  display:grid;
  grid-template-columns: 1fr;
  gap: 14px;
  align-items: start;
  justify-items: center;
}

.flame-stage{
  position: relative;
  width: min(90vw, 620px);
  height: min(60vh, 420px);
  background: #000;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 0 14px rgba(0,0,0,.6);
}

#selfieVideo, #selfieCanvas{
  position:absolute; inset:0;
  width:100%; height:100%;
  object-fit: cover; /* permite zoom sem deformar muito */
  transform-origin: center center;
}

.hidden{ display:none !important; }

/* Máscara em forma de chama usando mask-image (SVG embutido) */
.flame-mask{
  position:absolute; inset:0; pointer-events:none;
  background:
    radial-gradient(ellipse at 50% 85%, rgba(255,170,60,.5), rgba(255,120,10,.0) 60%),
    radial-gradient(circle at 50% 10%, rgba(255,220,160,.95), rgba(255,130,30,.0) 55%);
  mix-blend-mode: screen;
}
.flame-stage{
  /* máscara que “recorta” em forma de chama */
  --flameMask: url("data:image/svg+xml;utf8,\
  <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 150'>\
    <path d='M50 2 C35 25 65 32 49 60 C41 75 25 72 23 92 C21 114 38 130 50 148 C62 130 79 114 77 92 C75 72 59 75 51 60 C35 30 65 25 50 2 Z' fill='black'/>\
  </svg>");
  -webkit-mask-image: var(--flameMask);
          mask-image: var(--flameMask);
  -webkit-mask-size: 90% 100%;
          mask-size: 90% 100%;
  -webkit-mask-position: center;
          mask-position: center;
  -webkit-mask-repeat: no-repeat;
          mask-repeat: no-repeat;
  background-color: #000; /* área fora da chama fica escura */
}

/* Controles */
.selfie-controls{
  display: grid;
  grid-template-columns: auto;
  gap: 10px;
  align-items: center;
  justify-items: center;
}
.ranges{
  display:flex;
  gap:16px;
  flex-wrap:wrap;
  justify-content:center;
}
.range{
  display:flex; flex-direction:column; align-items:center; gap:6px;
  font-family: 'Cardo', serif; color:#f1e6c7;
}
.range input[type="range"]{ width: 220px; }

/* Ações */
.selfie-actions{
  display:flex;
  justify-content:center;
  gap: 18px;
  margin-top: 8px;
}

/* Pré-visualização */
.selfie-preview-wrap{
  display:flex; justify-content:center; margin-top:12px;
}
.preview-frame{
  width: min(90vw, 520px);
  height: auto;
  border: 2px solid rgba(255,215,0,.4);
  border-radius: 12px;
  padding: 8px;
  background: rgba(0,0,0,.2);
}
#selfiePreview{
  display:block; width:100%; height:auto; border-radius:8px;
}


/* SAFETY: garante que blocos essenciais não fiquem ocultos por herança */
.selfie-header,
.moldura-orientacao,
.selfie-grid,
.selfie-controls,
.selfie-actions,
.selfie-preview-wrap {
  display: block;
  opacity: 1 !important;
  visibility: visible !important;
}
.selfie-grid { display: grid; grid-template-columns: 1fr; gap: 14px; }
.btn[disabled] { opacity: .6; cursor: not-allowed; }
/* Safety: garante exibição dos blocos essenciais */
.selfie-header,
.moldura-orientacao,
.selfie-grid,
.selfie-controls,
.selfie-actions,
.selfie-preview-wrap {
  opacity: 1 !important;
  visibility: visible !important;
}
